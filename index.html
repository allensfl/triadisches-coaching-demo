<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triadisches KI-Coaching - Live Demo</title>
    <meta name="description" content="Erleben Sie die Zukunft des Coachings: Klient + Coach + KI in einer innovativen Demo-Umgebung">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎯</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --apple-blue: #007dfb;
            --apple-blue-light: #4da7ff;
            --apple-gray-50: #f2f2f7;
            --apple-gray-100: #e5e5ea;
            --apple-gray-200: #d1d1d6;
            --apple-gray-600: #8e8e93;
            --apple-gray-900: #1d1d1f;
            --apple-white: #ffffff;
            --success-green: #28a745;
            --warning-orange: #fd7e14;
            --purple-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f7;
            color: var(--apple-gray-900);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            margin-bottom: 2rem;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--purple-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-subtitle {
            font-size: 1.2rem;
            color: var(--apple-gray-600);
            margin-bottom: 2rem;
        }

        .demo-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--success-green);
            background: rgba(40, 167, 69, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-green);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--apple-blue);
        }

        .loading-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid #e5e5ea;
            border-top: 2px solid var(--apple-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error States */
        .error-message {
            background: rgba(255, 59, 48, 0.1);
            border: 1px solid #ff3b30;
            color: #d70015;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .api-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 0.5rem 1rem;
            border-radius: 16px;
            font-size: 0.8rem;
            z-index: 4000;
        }

        .api-status.connected {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-green);
            border: 1px solid var(--success-green);
        }

        .api-status.fallback {
            background: rgba(255, 193, 7, 0.1);
            color: var(--warning-orange);
            border: 1px solid var(--warning-orange);
        }

        /* Rest of your existing CSS stays the same... */
        /* Client Selection */
        .client-selection {
            background: white;
            border-radius: 20px;
            padding: 3rem 2rem;
            margin: 2rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .selection-title {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 1rem;
            background: var(--purple-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .selection-subtitle {
            font-size: 1.1rem;
            color: var(--apple-gray-600);
            text-align: center;
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .clients-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .client-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .client-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.2);
            border-color: var(--apple-blue-light);
        }

        .client-card.selected {
            border-color: var(--apple-blue);
            background: linear-gradient(135deg, #fff 0%, #f8faff 100%);
            transform: translateY(-4px);
        }

        .client-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 700;
            color: white;
        }

        .client-name {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .client-situation {
            font-size: 1rem;
            color: var(--apple-blue);
            font-weight: 500;
            margin-bottom: 1rem;
            text-align: center;
        }

        .client-description {
            font-size: 0.9rem;
            color: var(--apple-gray-600);
            text-align: left;
            line-height: 1.5;
        }

        .start-coaching-btn {
            background: var(--purple-gradient);
            color: white;
            border: none;
            padding: 1.5rem 3rem;
            border-radius: 16px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
            opacity: 0.5;
            pointer-events: none;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }

        .start-coaching-btn.active {
            opacity: 1;
            pointer-events: all;
        }

        .start-coaching-btn:hover.active {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4);
        }

        /* Coach Dashboard */
        .coach-dashboard {
            display: none;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-top: 2rem;
        }

        .dashboard-header {
            background: var(--purple-gradient);
            color: white;
            padding: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .client-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .client-info-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            background: rgba(255, 255, 255, 0.2);
        }

        .client-details h3 {
            font-size: 1.4rem;
            margin-bottom: 0.25rem;
        }

        .client-details p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .session-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        /* Steps Navigation */
        .steps-section {
            background: var(--apple-gray-50);
            padding: 2rem;
            border-bottom: 1px solid var(--apple-gray-200);
        }

        .steps-title {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--apple-gray-900);
        }

        .steps-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .step-button {
            background: white;
            border: 2px solid var(--apple-gray-200);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .step-button:hover {
            border-color: var(--apple-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .step-button.current {
            background: var(--apple-blue);
            color: white;
            border-color: var(--apple-blue);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }

        .step-button.done {
            background: var(--success-green);
            color: white;
            border-color: var(--success-green);
        }

        .step-num {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .step-name {
            font-size: 0.8rem;
            font-weight: 500;
            line-height: 1.2;
        }

        /* Main Working Area */
        .working-area {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            min-height: 600px;
        }

        .work-panel {
            padding: 2rem;
            border-right: 1px solid var(--apple-gray-200);
            display: flex;
            flex-direction: column;
        }

        .work-panel:last-child {
            border-right: none;
        }

        .panel-header {
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--apple-gray-900);
        }

        /* Chat Panel */
        .chat-panel {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .chat-area {
            background: white;
            border: 1px solid var(--apple-gray-200);
            border-radius: 12px;
            padding: 1.5rem;
            height: 350px;
            overflow-y: auto;
            margin-bottom: 1rem;
            flex: 1;
        }

        .chat-message {
            background: var(--apple-gray-100);
            padding: 1rem 1.5rem;
            border-radius: 18px;
            margin-bottom: 1rem;
            position: relative;
            max-width: 85%;
        }

        .chat-message.from-client {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-bottom-left-radius: 6px;
        }

        .chat-message.from-coach {
            background: var(--apple-blue);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 6px;
        }

        .chat-message.from-ai {
            background: var(--purple-gradient);
            color: white;
            margin: 1rem auto;
            max-width: 90%;
            text-align: center;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 0.5rem;
        }

        .chat-inputs {
            display: flex;
            gap: 0.75rem;
            align-items: flex-end;
        }

        .chat-input-field {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid var(--apple-gray-200);
            border-radius: 20px;
            font-size: 0.9rem;
            outline: none;
            resize: none;
            min-height: 40px;
            max-height: 100px;
        }

        .chat-input-field:focus {
            border-color: var(--apple-blue);
        }

        .chat-send-btn {
            background: var(--apple-blue);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .chat-send-btn:hover {
            background: var(--apple-blue-light);
            transform: scale(1.05);
        }

        /* AI Panel */
        .ai-panel {
            background: white;
        }

        .current-step-display {
            background: linear-gradient(135deg, #f8faff 0%, #f0f4ff 100%);
            border: 1px solid var(--apple-blue-light);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            flex: 1;
        }

        .step-info h4 {
            color: var(--apple-blue);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .step-desc {
            color: var(--apple-gray-600);
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .coach-guide {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid var(--apple-blue);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .coach-guide h5 {
            color: var(--apple-blue);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .coach-guide p {
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .prompt-area {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid var(--warning-orange);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .prompt-area h5 {
            color: var(--warning-orange);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .prompt-display {
            background: white;
            padding: 0.75rem;
            border-radius: 6px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.8rem;
            border: 1px solid var(--apple-gray-200);
            margin-bottom: 0.75rem;
        }

        .action-btns {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--apple-blue);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--apple-blue-light);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--apple-gray-200);
            color: var(--apple-gray-900);
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--apple-gray-600);
            color: white;
        }

        .btn-success {
            background: var(--success-green);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background: #20c997;
        }

        /* Tools Panel */
        .tools-panel {
            background: linear-gradient(135deg, #f1f3f4 0%, #e8eaf6 100%);
        }

        .tool-group {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--apple-gray-200);
        }

        .tool-group h4 {
            color: var(--apple-gray-900);
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .tool-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .tool-item {
            background: var(--apple-gray-50);
            border: 1px solid var(--apple-gray-200);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            text-align: left;
            transition: all 0.3s ease;
        }

        .tool-item:hover {
            background: var(--apple-blue);
            color: white;
            border-color: var(--apple-blue);
        }

        /* Prompt Editor Modal */
        .prompt-editor-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .prompt-editor-window {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--apple-gray-200);
        }

        .editor-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--apple-gray-900);
        }

        .close-editor {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--apple-gray-600);
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .close-editor:hover {
            background: var(--apple-gray-100);
        }

        .collaboration-notice {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            border: 1px solid var(--success-green);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: var(--apple-gray-700);
        }

        .collaboration-notice strong {
            color: var(--success-green);
        }

        .prompt-work-section {
            background: var(--apple-gray-50);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .work-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--apple-gray-700);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .prompt-textarea {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid var(--apple-gray-200);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Monaco', 'Courier New', monospace;
            line-height: 1.5;
            resize: vertical;
            outline: none;
            background: white;
        }

        .prompt-textarea:focus {
            border-color: var(--apple-blue);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .variables-section {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid var(--warning-orange);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .variables-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--warning-orange);
            margin-bottom: 0.75rem;
        }

        .variable-row {
            background: white;
            border: 1px solid rgba(253, 126, 20, 0.3);
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .variable-row:last-child {
            margin-bottom: 0;
        }

        .variable-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--warning-orange);
            margin-bottom: 0.25rem;
        }

        .variable-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--apple-gray-200);
            border-radius: 6px;
            font-size: 0.9rem;
            outline: none;
        }

        .variable-input:focus {
            border-color: var(--apple-blue);
        }

        .editor-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .btn-large {
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 12px;
        }

        .screen-share-alert {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff4757, #ff6b7d);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 3000;
            display: none;
            animation: pulseAlert 2s infinite;
        }

        @keyframes pulseAlert {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 1200px) {
            .working-area {
                grid-template-columns: 1fr;
                gap: 0;
            }
            
            .work-panel {
                border-right: none;
                border-bottom: 1px solid var(--apple-gray-200);
            }
            
            .work-panel:last-child {
                border-bottom: none;
            }
        }

        @media (max-width: 768px) {
            .clients-grid {
                grid-template-columns: 1fr;
            }
            
            .steps-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem;
            }
            
            .step-button {
                min-height: 80px;
                padding: 0.75rem;
            }
            
            .step-name {
                font-size: 0.7rem;
            }

            .dashboard-header {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- API Status Indicator -->
    <div class="api-status" id="apiStatus">
        <span class="loading-spinner"></span> Verbinde...
    </div>

    <div class="container">
        <header>
            <h1 class="header-title">Triadisches KI-Coaching</h1>
            <p class="header-subtitle">Erleben Sie die Zukunft des Coachings: Klient + Coach + KI</p>
            <div class="demo-status">
                <div class="status-dot"></div>
                Live Demo mit OpenAI Integration
            </div>
        </header>

        <!-- Client Selection Screen -->
        <div class="client-selection" id="clientSelection">
            <h2 class="selection-title">Wählen Sie Ihren Demo-Klienten</h2>
            <p class="selection-subtitle">
                Erleben Sie eine komplette Coaching-Session aus Coach-Perspektive mit authentischen Klienten-Profilen und echter KI-Integration
            </p>

            <div class="clients-grid">
                <div class="client-card" onclick="selectClient('sarah')">
                    <div class="client-avatar" style="background: linear-gradient(135deg, #ff6b6b, #ff8e8e);">S</div>
                    <h3 class="client-name">Sarah Weber</h3>
                    <p class="client-situation">Karrierewechsel mit 35</p>
                    <div class="client-description">
                        <p><strong>Situation:</strong> Erfolgreiche Marketing-Managerin, die ihre Passion im nachhaltigen Design entdeckt hat. Ängste vor Neustart und finanziellen Einbußen.</p>
                        <br>
                        <p><strong>Coaching-Ziel:</strong> Klarheit über Übergangsschritte und Umgang mit Unsicherheit.</p>
                    </div>
                </div>

                <div class="client-card" onclick="selectClient('marcus')">
                    <div class="client-avatar" style="background: linear-gradient(135deg, #4dabf7, #339af0);">M</div>
                    <h3 class="client-name">Marcus Hoffmann</h3>
                    <p class="client-situation">Midlife-Neuorientierung</p>
                    <div class="client-description">
                        <p><strong>Situation:</strong> IT-Führungskraft, 48 Jahre, fühlt sich beruflich ausgebrannt. Träumt von eigenem Café, aber Familie ist skeptisch.</p>
                        <br>
                        <p><strong>Coaching-Ziel:</strong> Authentische Lebensvision entwickeln und erste Schritte planen.</p>
                    </div>
                </div>

                <div class="client-card" onclick="selectClient('lisa')">
                    <div class="client-avatar" style="background: linear-gradient(135deg, #51cf66, #40c057);">L</div>
                    <h3 class="client-name">Lisa Chen</h3>
                    <p class="client-situation">Work-Life-Balance</p>
                    <div class="client-description">
                        <p><strong>Situation:</strong> Junge Mutter und Startup-Gründerin, kämpft mit Zeitmanagement und Schuldgefühlen. Perfektionismus blockiert Delegation.</p>
                        <br>
                        <p><strong>Coaching-Ziel:</strong> Gesunde Grenzen setzen und Prioritäten neu definieren.</p>
                    </div>
                </div>

                <div class="client-card" onclick="selectClient('werner')">
                    <div class="client-avatar" style="background: linear-gradient(135deg, #845ec2, #b39ddb);">W</div>
                    <h3 class="client-name">Werner Müller</h3>
                    <p class="client-situation">Ruhestand-Übergang</p>
                    <div class="client-description">
                        <p><strong>Situation:</strong> Langjähriger Abteilungsleiter, 62 Jahre, steht vor der Rente. Fühlt sich zwischen "endlich frei sein" und Sinnverlust hin- und hergerissen.</p>
                        <br>
                        <p><strong>Coaching-Ziel:</strong> Neuen Lebenssinn finden und den Übergang bewusst gestalten.</p>
                    </div>
                </div>
            </div>

            <button class="start-coaching-btn" id="startCoachingBtn" onclick="startCoaching()">
                🚀 Coaching-Session starten
            </button>
        </div>

        <!-- Coach Dashboard -->
        <div class="coach-dashboard" id="coachDashboard">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="client-info">
                    <div class="client-info-avatar" id="dashboardAvatar">K</div>
                    <div class="client-details">
                        <h3 id="dashboardClientName">Klient gewählt</h3>
                        <p id="dashboardClientSituation">Session aktiv</p>
                    </div>
                </div>
                <div class="session-controls">
                    <button class="control-btn" onclick="showPrompts()">📚 Prompts</button>
                    <button class="control-btn" onclick="showAvatarTool()">🎭 Avatar-Tool</button>
                    <button class="control-btn" onclick="exportSession()">💾 Export</button>
                </div>
            </div>

            <!-- 12-Schritte Navigation -->
            <div class="steps-section">
                <h3 class="steps-title">12 Schritte des triadischen KI-Coachings</h3>
                <div class="steps-container" id="stepsContainer">
                    <!-- Steps werden hier eingefügt -->
                </div>
            </div>

            <!-- Main Working Area -->
            <div class="working-area">
                <!-- Chat Panel -->
                <div class="work-panel chat-panel">
                    <h3 class="panel-header">💬 Coachee Dialog</h3>
                    <div class="chat-area" id="chatArea">
                        <!-- Chat messages hier -->
                    </div>
                    <div class="chat-inputs">
                        <textarea class="chat-input-field" id="chatInput" placeholder="Nachricht eingeben..." rows="2"></textarea>
                        <button class="chat-send-btn" onclick="sendMessage()">Senden</button>
                    </div>
                </div>

                <!-- AI Assistant Panel -->
                <div class="work-panel ai-panel">
                    <h3 class="panel-header">🤖 KI-Assistent</h3>
                    <div class="current-step-display" id="stepDisplay">
                        <div class="step-info">
                            <h4>Schritt auswählen</h4>
                            <p class="step-desc">Wählen Sie einen Schritt aus der Navigation oben.</p>
                        </div>
                    </div>
                </div>

                <!-- Tools Panel -->
                <div class="work-panel tools-panel">
                    <h3 class="panel-header">🛠️ Coach-Tools</h3>
                    
                    <div class="tool-group">
                        <h4>🎯 Coaching-Techniken</h4>
                        <div class="tool-list">
                            <button class="tool-item">👂 Aktives Zuhören</button>
                            <button class="tool-item">❓ Offene Fragen</button>
                            <button class="tool-item">🪞 Paraphrasieren</button>
                            <button class="tool-item">💭 Emotionen spiegeln</button>
                        </div>
                    </div>

                    <div class="tool-group">
                        <h4>📊 KI-Analyse</h4>
                        <div class="tool-list">
                            <button class="tool-item">🔍 Muster erkennen</button>
                            <button class="tool-item">⚖️ Ausbalancierung</button>
                            <button class="tool-item">💡 Insights</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prompt Editor Modal -->
        <div class="prompt-editor-modal" id="promptEditorModal">
            <div class="prompt-editor-window">
                <div class="editor-header">
                    <h3 class="editor-title">🔧 Prompt-Werkstatt (Kollaborativ)</h3>
                    <button class="close-editor" onclick="closePromptEditor()">×</button>
                </div>

                <div class="collaboration-notice">
                    <strong>💬 Bildschirm-Sharing:</strong> Teilen Sie dieses Fenster mit dem Klienten, damit er mitverfolgen kann, wie Sie den Prompt gemeinsam anpassen. Der Klient sieht nur diesen Arbeitsbereich, nicht Ihre anderen Coach-Tools.
                </div>

                <div class="prompt-work-section">
                    <div class="work-section-title">
                        ✏️ Prompt gemeinsam bearbeiten
                    </div>
                    <textarea class="prompt-textarea" id="promptTextarea" placeholder="Hier wird der Prompt für diesen Schritt bearbeitet..."></textarea>
                </div>

                <div class="variables-section">
                    <div class="variables-title">🔧 Variablen mit Klient-Input ersetzen</div>
                    <div class="variable-row">
                        <div class="variable-label">[PROBLEMBESCHREIBUNG] ersetzen durch:</div>
                        <input type="text" class="variable-input" id="varProblem" placeholder="z.B. Ich zögere immer, wenn ich mein LinkedIn-Profil aktualisieren soll...">
                    </div>
                    <div class="variable-row">
                        <div class="variable-label">[DETAILS] ersetzen durch:</div>
                        <input type="text" class="variable-input" id="varDetails" placeholder="z.B. Besonders schlimm ist es an freien Nachmittagen...">
                    </div>
                    <div class="variable-row">
                        <div class="variable-label">[ZIELBESCHREIBUNG] ersetzen durch:</div>
                        <input type="text" class="variable-input" id="varGoal" placeholder="z.B. Selbstbewusst mein berufliches Profil präsentieren...">
                    </div>
                </div>

                <div class="editor-actions">
                    <button class="btn btn-secondary" onclick="resetPrompt()">🔄 Zurücksetzen</button>
                    <button class="btn btn-primary" onclick="previewFinalPrompt()">👁️ Vorschau</button>
                    <button class="btn btn-success btn-large" id="sendToKIBtn" onclick="sendPromptToKI()">🚀 An KI senden</button>
                </div>
            </div>
        </div>

        <!-- Screen Share Alert -->
        <div class="screen-share-alert" id="screenShareAlert">
            🔴 Bildschirm wird geteilt - Klient kann mitsehen
        </div>
    </div>

    <script>
        let selectedClient = null;
        let currentStep = 1;
        let completedSteps = [];
        let currentEditingStep = null;
        let clientData = null;
        let isAPIConnected = false;

        // API Endpoint - wird automatisch erkannt (lokal vs. deployed)
        const API_BASE = window.location.hostname === 'localhost' 
            ? 'http://localhost:3000' 
            : window.location.origin;

        // 12 Schritte Daten
        const coachingSteps = [
            { 
                id: 1, 
                name: "Einstieg", 
                desc: "Rapport aufbauen, Anliegen klären", 
                prompt: "Ich habe folgendes Anliegen: [PROBLEMBESCHREIBUNG]. Kannst du mir helfen, das strukturiert zu durchdenken und erste Lösungsansätze zu entwickeln? Bitte spiegle mir das Anliegen in eigenen Worten und gib mir wertschätzendes Feedback."
            },
            { 
                id: 2, 
                name: "Ist/Soll", 
                desc: "Strukturierte Situationsbeschreibung",
                prompt: "Hier folgen weitere Informationen zu meiner Situation: [DETAILS]. Bitte erstelle einen strukturierten Bericht in Ich-Form mit zwei Abschnitten: 1. IST-Zustand (was mich derzeit beschäftigt, meine Gefühle und aktuelle Situation) und 2. SOLL-Zustand (wie ich es mir wünsche, meine Ziele)."
            },
            { 
                id: 3, 
                name: "Bildarbeit", 
                desc: "Emotionales Zielbild aktivieren",
                prompt: "Hier ist eine Bildbeschreibung, die mein Ziel symbolisiert: [ZIELBESCHREIBUNG]. Bitte analysiere die Beziehung zwischen diesem Bild und meinem formulierten Coaching-Ziel. Welche Symbolik erkennst du und wie verbindet sich das Bild mit meinen Zielen?"
            },
            { 
                id: 4, 
                name: "Ausbalancierung", 
                desc: "Innere Konflikte identifizieren",
                prompt: "Basierend auf allem was bisher besprochen wurde: [PROBLEMBESCHREIBUNG] und [DETAILS]. Identifiziere mögliche Ausbalancierungsprobleme oder innere Konfliktdimensionen. Welche Fragen sollte ich mir stellen, um diese Konflikte besser zu verstehen?"
            },
            { 
                id: 5, 
                name: "Schlüsselsituation", 
                desc: "Problemkern erkennen",
                prompt: "Beschreibe basierend auf meinen Schilderungen die zentrale Schlüsselsituation, in der mein Problem am stärksten auftritt. Was ist der Hauptaffekt (Gefühl), den ich dabei erlebe? Erkenne Muster und Auslöser."
            },
            { 
                id: 6, 
                name: "Avatar-Interview", 
                desc: "Inneres Team erkunden",
                prompt: "Führe ein Interview mit meinem inneren Team durch. Stelle dir vor, es gibt drei Anteile in mir: die Teamchefin (rational, zielorientiert), die Unterstützerin (motivierend, optimistisch) und die Bremse (vorsichtig, warnend). Was würde jeder Anteil zu meinem Anliegen sagen?"
            },
            { 
                id: 7, 
                name: "KI-Analyse", 
                desc: "Tiefere Ursachen analysieren",
                prompt: "Analysiere meine Persönlichkeitsanteile und erstelle ein Ranking der wichtigsten Ausbalancierungsdimensionen für meine Situation. Entwickle ein Ursachenmodell: Wie hängen meine Probleme zusammen?"
            },
            { 
                id: 8, 
                name: "Entwicklungsziel", 
                desc: "Übergeordnetes Ziel formulieren",
                prompt: "Formuliere basierend auf den bisherigen Erkenntnissen ein übergeordnetes Lern- und Entwicklungsziel für mich. Es soll über das konkrete Problem hinausgehen und nachhaltige Veränderung ermöglichen."
            },
            { 
                id: 9, 
                name: "Widerstände", 
                desc: "Umsetzungsblockaden antizipieren",
                prompt: "Identifiziere die inneren Widerstände, die mich bei der Umsetzung meiner Ziele behindern könnten. Welche Ängste und Bedenken haben diese Widerstände? Wie können sie gewürdigt und transformiert werden?"
            },
            { 
                id: 10, 
                name: "Widerstandsanalyse", 
                desc: "Glaubenssätze erkennen",
                prompt: "Extrahiere aus meinen Widerstandsaussagen die zugrundeliegenden negativen Glaubenssätze und inneren Regeln. Entwickle positive alternative Glaubenssätze, die mich stärken."
            },
            { 
                id: 11, 
                name: "Erfolgsimagination", 
                desc: "Mentale Erfolgsvorwegnahme",
                prompt: "Erstelle eine lebhafte Erfolgsimagination in Ich-Form. Zeige den Kontrast zwischen dem alten und neuen Erleben. Beschreibe sinnlich und detailreich, wie es ist, wenn ich mein Ziel erreicht habe. Beziehe mein Zielbild mit ein."
            },
            { 
                id: 12, 
                name: "Umsetzungsplan", 
                desc: "Transfer in den Alltag",
                prompt: "Entwickle einen praktischen Umsetzungsplan mit 5-7 konkreten Maßnahmen, Zeitrahmen und Meilensteinen. Integriere die Erfolgsimagination und schlage Unterstützungsstrukturen vor."
            }
        ];

        // API Connection Check
        async function checkAPIConnection() {
            try {
                const response = await fetch(`${API_BASE}/api/coaching-ai`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        prompt: 'Test', 
                        stepId: 1 
                    })
                });
                
                if (response.ok) {
                    isAPIConnected = true;
                    updateAPIStatus('connected', '🟢 OpenAI verbunden');
                } else {
                    isAPIConnected = false;
                    updateAPIStatus('fallback', '🟡 Demo-Modus');
                }
            } catch (error) {
                isAPIConnected = false;
                updateAPIStatus('fallback', '🟡 Demo-Modus');
            }
        }

        function updateAPIStatus(status, text) {
            const statusEl = document.getElementById('apiStatus');
            statusEl.className = `api-status ${status}`;
            statusEl.innerHTML = text;
        }

        // Client Selection
        function selectClient(clientKey) {
            document.querySelectorAll('.client-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            event.currentTarget.classList.add('selected');
            selectedClient = clientKey;
            
            const startBtn = document.getElementById('startCoachingBtn');
            startBtn.classList.add('active');
        }

        function startCoaching() {
            if (!selectedClient) return;
            
            const clients = {
                sarah: { name: 'Sarah Weber', situation: 'Karrierewechsel mit 35', avatar: 'S', color: 'linear-gradient(135deg, #ff6b6b, #ff8e8e)' },
                marcus: { name: 'Marcus Hoffmann', situation: 'Midlife-Neuorientierung', avatar: 'M', color: 'linear-gradient(135deg, #4dabf7, #339af0)' },
                lisa: { name: 'Lisa Chen', situation: 'Work-Life-Balance', avatar: 'L', color: 'linear-gradient(135deg, #51cf66, #40c057)' },
                werner: { name: 'Werner Müller', situation: 'Ruhestand-Übergang', avatar: 'W', color: 'linear-gradient(135deg, #845ec2, #b39ddb)' }
            };
            
            clientData = clients[selectedClient];
            
            document.getElementById('clientSelection').style.display = 'none';
            document.getElementById('coachDashboard').style.display = 'block';
            
            const avatar = document.getElementById('dashboardAvatar');
            avatar.textContent = clientData.avatar;
            avatar.style.background = clientData.color;
            
            document.getElementById('dashboardClientName').textContent = clientData.name;
            document.getElementById('dashboardClientSituation').textContent = clientData.situation;

            initializeCoaching();
        }

        function initializeCoaching() {
            renderSteps();
            showStep(1);
            addChatMessage('coach', 'Hallo! Schön, dass Sie da sind. Erzählen Sie mir, was Sie heute beschäftigt.');
            
            setTimeout(() => {
                addChatMessage('client', 'Hallo... ich bin etwas nervös. Ich stehe vor einer wichtigen Entscheidung und weiß nicht, ob ich den Mut dazu habe.');
            }, 2000);
        }

        function renderSteps() {
            const container = document.getElementById('stepsContainer');
            container.innerHTML = '';
            
            coachingSteps.forEach(step => {
                const stepBtn = document.createElement('button');
                stepBtn.className = 'step-button';
                
                if (step.id === currentStep) {
                    stepBtn.classList.add('current');
                }
                if (completedSteps.includes(step.id)) {
                    stepBtn.classList.add('done');
                }
                
                stepBtn.onclick = () => showStep(step.id);
                
                stepBtn.innerHTML = `
                    <div class="step-num">${step.id}</div>
                    <div class="step-name">${step.name}</div>
                `;
                
                container.appendChild(stepBtn);
            });
        }

        function showStep(stepId) {
            currentStep = stepId;
            const step = coachingSteps.find(s => s.id === stepId);
            
            if (!step) return;
            
            renderSteps();
            
            const display = document.getElementById('stepDisplay');
            display.innerHTML = `
                <div class="step-info">
                    <h4>Schritt ${step.id}: ${step.name}</h4>
                    <p class="step-desc">${step.desc}</p>
                </div>
                
                <div class="coach-guide">
                    <h5>👨‍💼 Coach-Anleitung:</h5>
                    <p>Führen Sie den Klienten durch diesen Schritt des triadischen Coaching-Prozesses. Nutzen Sie den Prompt als Grundlage für die KI-Unterstützung.</p>
                </div>
                
                <div class="prompt-area">
                    <h5>🤖 KI-Prompt:</h5>
                    <div class="prompt-display">${step.prompt}</div>
                    <div class="action-btns">
                        <button class="btn btn-primary" onclick="openPromptEditor(${step.id})">✏️ Prompt bearbeiten</button>
                        <button class="btn btn-success" onclick="sendToAI(${step.id})">🚀 An KI senden</button>
                    </div>
                </div>
            `;
        }

        function addChatMessage(sender, text) {
            const chatArea = document.getElementById('chatArea');
            const msgDiv = document.createElement('div');
            msgDiv.className = `chat-message from-${sender}`;
            
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ':' + 
                           now.getMinutes().toString().padStart(2, '0');
            
            msgDiv.innerHTML = `
                <div>${text}</div>
                <div class="message-time">${timeStr}</div>
            `;
            
            chatArea.appendChild(msgDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            addChatMessage('client', text);
            input.value = '';
            
            setTimeout(() => {
                const responses = [
                    "Das ist eine wichtige Beobachtung. Erzählen Sie mir mehr davon.",
                    "Wie fühlt sich das für Sie an?",
                    "Was würde sich ändern, wenn das Problem gelöst wäre?",
                    "Welche Ressourcen haben Ihnen schon mal geholfen?"
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage('coach', randomResponse);
            }, 1500);
        }

        // Prompt Editor Functions
        function openPromptEditor(stepId) {
            currentEditingStep = stepId;
            const step = coachingSteps.find(s => s.id === stepId);
            
            if (!step) return;
            
            document.getElementById('promptTextarea').value = step.prompt;
            document.getElementById('varProblem').value = '';
            document.getElementById('varDetails').value = '';
            document.getElementById('varGoal').value = '';
            
            document.getElementById('promptEditorModal').style.display = 'block';
            document.getElementById('screenShareAlert').style.display = 'block';
        }

        function closePromptEditor() {
            document.getElementById('promptEditorModal').style.display = 'none';
            document.getElementById('screenShareAlert').style.display = 'none';
            currentEditingStep = null;
        }

        function resetPrompt() {
            if (currentEditingStep) {
                const step = coachingSteps.find(s => s.id === currentEditingStep);
                if (step) {
                    document.getElementById('promptTextarea').value = step.prompt;
                    document.getElementById('varProblem').value = '';
                    document.getElementById('varDetails').value = '';
                    document.getElementById('varGoal').value = '';
                }
            }
        }

        function previewFinalPrompt() {
            let promptText = document.getElementById('promptTextarea').value;
            const problem = document.getElementById('varProblem').value;
            const details = document.getElementById('varDetails').value;
            const goal = document.getElementById('varGoal').value;
            
            if (problem) promptText = promptText.replace(/\[PROBLEMBESCHREIBUNG\]/g, problem);
            if (details) promptText = promptText.replace(/\[DETAILS\]/g, details);
            if (goal) promptText = promptText.replace(/\[ZIELBESCHREIBUNG\]/g, goal);
            
            alert('📋 Finaler Prompt:\n\n' + promptText);
        }

        async function sendPromptToKI() {
            let promptText = document.getElementById('promptTextarea').value;
            const problem = document.getElementById('varProblem').value;
            const details = document.getElementById('varDetails').value;
            const goal = document.getElementById('varGoal').value;
            
            // Variablen ersetzen
            if (problem) promptText = promptText.replace(/\[PROBLEMBESCHREIBUNG\]/g, problem);
            if (details) promptText = promptText.replace(/\[DETAILS\]/g, details);
            if (goal) promptText = promptText.replace(/\[ZIELBESCHREIBUNG\]/g, goal);
            
            closePromptEditor();
            
            // Loading State
            const sendBtn = document.getElementById('sendToKIBtn');
            const originalText = sendBtn.innerHTML;
            sendBtn.innerHTML = '<span class="loading-spinner"></span> Sende...';
            sendBtn.disabled = true;
            
            try {
                await sendToAIWithPrompt(currentEditingStep, promptText);
            } finally {
                sendBtn.innerHTML = originalText;
                sendBtn.disabled = false;
            }
        }

        async function sendToAI(stepId) {
            const step = coachingSteps.find(s => s.id === stepId);
            await sendToAIWithPrompt(stepId, step.prompt);
        }

        async function sendToAIWithPrompt(stepId, prompt) {
            try {
                addChatMessage('ai', '<div class="loading">🤖 <span class="loading-spinner"></span> KI analysiert...</div>');
                
                const response = await fetch(`${API_BASE}/api/coaching-ai`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        stepId: stepId,
                        clientName: clientData?.name,
                        clientSituation: clientData?.situation
                    })
                });

                const data = await response.json();
                
                // Remove loading message
                const chatArea = document.getElementById('chatArea');
                const lastMessage = chatArea.lastElementChild;
                if (lastMessage && lastMessage.innerHTML.includes('loading-spinner')) {
                    chatArea.removeChild(lastMessage);
                }
                
                if (response.ok) {
                    addChatMessage('ai', `🤖 ${data.response}`);
                    
                    if (data.fallback) {
                        updateAPIStatus('fallback', '🟡 Demo-Modus');
                    }
                } else {
                    throw new Error(data.error || 'API Error');
                }
                
                // Mark step as completed
                if (!completedSteps.includes(stepId)) {
                    completedSteps.push(stepId);
                    renderSteps();
                }
                
            } catch (error) {
                console.error('AI API Error:', error);
                
                // Remove loading message
                const chatArea = document.getElementById('chatArea');
                const lastMessage = chatArea.lastElementChild;
                if (lastMessage && lastMessage.innerHTML.includes('loading-spinner')) {
                    chatArea.removeChild(lastMessage);
                }
                
                // Fallback response
                const fallbackResponses = {
                    1: "🤖 **Vielen Dank für Ihr Vertrauen!** [Offline-Modus] Ich höre heraus, dass Sie vor einer wichtigen Entscheidung stehen. Ihre Selbstreflexion ist bereits eine große Stärke.",
                    2: "🤖 **Strukturierte Analyse** [Offline-Modus]: IST-Zustand zeigt äußeren Erfolg, aber innere Unzufriedenheit. SOLL-Zustand: Authentische, erfüllende Tätigkeit.",
                    3: "🤖 **Bildsymbolik-Analyse** [Offline-Modus]: Das gewählte Bild symbolisiert neue Perspektiven und Möglichkeiten."
                };
                
                const fallbackResponse = fallbackResponses[stepId] || 
                    `🤖 [Offline-Modus] Analyse für Schritt ${stepId}. In der Live-Version würde hier eine detaillierte KI-Antwort erscheinen.`;
                
                addChatMessage('ai', fallbackResponse);
                updateAPIStatus('fallback', '🔴 Offline-Modus');
            }
        }

        // Tool Functions
        function showPrompts() {
            alert('📚 Prompt-Repository\n\nIn der vollständigen Version stehen hier 83+ spezialisierte Coaching-Prompts zur Verfügung, kategorisiert nach Coaching-Phasen und Anwendungsgebieten.');
        }

        function showAvatarTool() {
            alert('🎭 Avatar-Tool\n\nHier würde das Tool für "Inneres Team" Aufstellungen starten. Klienten können virtuelle Avatare für ihre verschiedenen Persönlichkeitsanteile aufstellen und Interviews führen.');
        }

        function exportSession() {
            const sessionData = {
                client: clientData,
                completedSteps: completedSteps,
                chatHistory: Array.from(document.querySelectorAll('.chat-message')).map(msg => ({
                    sender: msg.className.split('from-')[1],
                    text: msg.querySelector('div').textContent,
                    time: msg.querySelector('.message-time')?.textContent
                })),
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(sessionData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `coaching-session-${clientData?.name || 'export'}-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Check API connection on load
            checkAPIConnection();
            
            // Chat input Enter key
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }

            // Close modals on outside click
            window.onclick = function(event) {
                const modal = document.getElementById('promptEditorModal');
                if (event.target === modal) {
                    closePromptEditor();
                }
            }
        });
    </script>
</body>
</html>