<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triadisches Coaching Demo - Live mit OpenAI Integration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.3em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .api-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .api-status.connected {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .api-status.demo {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .api-status.error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .client-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .client-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .client-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .client-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
        }

        .client-card:hover::before {
            opacity: 1;
        }

        .client-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(102, 126, 234, 0.3);
        }

        .client-card.selected::before {
            opacity: 1;
        }

        .client-card h3 {
            color: #667eea;
            font-size: 1.4em;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .client-card .age {
            color: #666;
            font-size: 1em;
            margin-bottom: 18px;
            font-weight: 500;
        }

        .client-card .problem {
            color: #333;
            line-height: 1.7;
            margin-bottom: 18px;
            font-size: 0.95em;
        }

        .client-card .goal {
            color: #667eea;
            font-weight: 600;
            font-size: 1em;
            padding: 10px 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .start-button {
            display: block;
            width: 350px;
            margin: 0 auto;
            padding: 18px 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.3em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.5;
            pointer-events: none;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .start-button.active {
            opacity: 1;
            pointer-events: auto;
        }

        .start-button:hover.active {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 35px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-header h2 {
            font-size: 1.6em;
            font-weight: 600;
        }

        .session-info {
            display: flex;
            align-items: center;
            gap: 25px;
            font-size: 0.9em;
        }

        .steps-navigation {
            background: linear-gradient(135deg, #f8faff 0%, #e8f2ff 100%);
            padding: 25px 35px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }

        .step-button {
            background: white;
            border: 2px solid #e5e7eb;
            padding: 15px 18px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9em;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .step-button:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, #f8faff 0%, #e8f2ff 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .step-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .main-interface {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            min-height: 650px;
        }

        .chat-panel, .ai-panel, .tools-panel {
            border-right: 1px solid rgba(102, 126, 234, 0.1);
            padding: 30px;
            overflow-y: auto;
        }

        .tools-panel {
            border-right: none;
        }

        .panel-header {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f3f4f6;
            font-size: 1.1em;
        }

        .chat-messages {
            height: 450px;
            overflow-y: auto;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #f8faff 0%, #e8f2ff 100%);
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .message {
            margin-bottom: 18px;
            padding: 15px 20px;
            border-radius: 18px;
            max-width: 85%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .message.coach {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
        }

        .message.client {
            background: white;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .message.ai {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            color: white;
        }

        .message .timestamp {
            font-size: 0.8em;
            opacity: 0.7;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .current-step-info {
            background: linear-gradient(135deg, #f8faff 0%, #e8f2ff 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .step-title {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .step-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 22px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
            transform: translateY(-1px);
        }

        .coach-tools {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .tool-section {
            background: linear-gradient(135deg, #f8faff 0%, #e8f2ff 100%);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .tool-section h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-weight: 600;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 35px;
            max-width: 900px;
            width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f3f4f6;
        }

        .modal-header h3 {
            color: #667eea;
            font-size: 1.4em;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.8em;
            cursor: pointer;
            color: #666;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            background: #f3f4f6;
            color: #333;
        }

        .screen-share-alert {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .prompt-editor {
            margin-bottom: 25px;
        }

        .prompt-editor label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #374151;
        }

        .prompt-editor textarea {
            width: 100%;
            min-height: 180px;
            padding: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-family: inherit;
            font-size: 0.95em;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .prompt-editor textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .variables-section {
            margin: 25px 0;
        }

        .variables-section h4 {
            color: #667eea;
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 1.1em;
        }

        .variable-input {
            margin-bottom: 20px;
        }

        .variable-input label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #374151;
        }

        .variable-input input {
            width: 100%;
            padding: 12px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .variable-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .ki-response-section {
            margin-top: 35px;
            border-top: 3px solid #f3f4f6;
            padding-top: 25px;
            display: none;
        }

        .ki-response-section.show {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ki-response {
            background: linear-gradient(135deg, #f8faff 0%, #e8f2ff 100%);
            border: 2px solid #667eea;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.15);
        }

        .ki-response-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
            color: #667eea;
            font-weight: 600;
            font-size: 1.1em;
        }

        .ki-response-text {
            line-height: 1.7;
            color: #333;
            font-size: 0.95em;
        }

        .response-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .loading-indicator {
            display: none;
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .loading-indicator.show {
            display: block;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .typing-indicator {
            display: none;
            color: #667eea;
            font-style: italic;
            padding: 15px;
            text-align: center;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            margin-top: 10px;
        }

        .typing-indicator.show {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-interface {
                grid-template-columns: 1fr;
                height: auto;
            }

            .chat-panel, .ai-panel, .tools-panel {
                border-right: none;
                border-bottom: 1px solid rgba(102, 126, 234, 0.1);
                padding: 20px;
            }

            .steps-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }

            .modal-content {
                width: 95%;
                padding: 25px;
            }

            .header h1 {
                font-size: 2.2em;
            }

            .start-button {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div id="apiStatus" class="api-status demo">🔄 KI wird getestet...</div>

    <div class="container">
        <!-- Client Selection Screen -->
        <div id="clientSelection" class="client-selection-screen">
            <div class="header">
                <h1>🚀 Triadisches Coaching Demo</h1>
                <p>Erleben Sie die Zukunft des Coachings: Coach + Klient + KI</p>
                <p style="font-size: 1em; opacity: 0.8;">Wählen Sie einen Klienten und erleben Sie das revolutionäre 3-Akteure-System live!</p>
            </div>

            <div class="client-selection" id="clientCards">
                <div class="client-card" data-client="sarah">
                    <h3>👩‍💼 Sarah Weber</h3>
                    <div class="age">35 Jahre, Marketing-Managerin</div>
                    <div class="problem">
                        Steht vor einem wichtigen Karrierewechsel. Nach 10 Jahren im Marketing zieht sie einen Wechsel in den nachhaltigen Sektor in Betracht, ist aber unsicher über die finanziellen Risiken und den richtigen Zeitpunkt.
                    </div>
                    <div class="goal">🎯 Ziel: Klarheit über Karrierewechsel gewinnen</div>
                </div>

                <div class="client-card" data-client="marcus">
                    <h3>👨‍🔧 Marcus Schmidt</h3>
                    <div class="age">48 Jahre, Ingenieur</div>
                    <div class="problem">
                        Durchlebt eine Midlife-Krise nach 20 Jahren in derselben Firma. Fühlt sich unterfordert und sehnt sich nach neuen Herausforderungen, hat aber Angst vor Veränderungen in seinem Alter.
                    </div>
                    <div class="goal">🎯 Ziel: Neue Perspektiven und Mut für Veränderung</div>
                </div>

                <div class="client-card" data-client="lisa">
                    <h3>👩‍⚕️ Dr. Lisa Müller</h3>
                    <div class="age">42 Jahre, Ärztin</div>
                    <div class="problem">
                        Kämpft mit der Balance zwischen ihrer Karriere als Chirurgin und dem Familienleben. Burnout-Symptome machen sich bemerkbar, aber sie liebt ihren Beruf und will nicht aufgeben.
                    </div>
                    <div class="goal">🎯 Ziel: Nachhaltige Work-Life-Balance finden</div>
                </div>

                <div class="client-card" data-client="werner">
                    <h3>👨‍💼 Werner Hoffmann</h3>
                    <div class="age">62 Jahre, Abteilungsleiter</div>
                    <div class="problem">
                        Steht vor dem Ruhestand und schwankt zwischen Vorfreude auf die Freiheit und Angst vor dem Verlust seiner beruflichen Identität. Sucht nach neuen Sinnstiftungen für die Zeit nach der Arbeit.
                    </div>
                    <div class="goal">🎯 Ziel: Bewussten Übergang in den Ruhestand gestalten</div>
                </div>
            </div>

            <button id="startButton" class="start-button">🚀 Coaching-Session starten</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-header">
                <h2 id="sessionTitle">Coaching-Session</h2>
                <div class="session-info">
                    <span id="currentTime"></span>
                    <button class="btn btn-secondary" onclick="exportSession()">📥 Session exportieren</button>
                </div>
            </div>

            <div class="steps-navigation">
                <div class="steps-grid" id="stepsGrid">
                    <!-- Steps werden dynamisch generiert -->
                </div>
            </div>

            <div class="main-interface">
                <div class="chat-panel">
                    <div class="panel-header">💬 Coaching-Gespräch</div>
                    <div class="chat-messages" id="chatMessages"></div>
                    <div class="typing-indicator" id="typingIndicator">KI analysiert...</div>
                </div>

                <div class="ai-panel">
                    <div class="panel-header">🤖 KI-Assistent</div>
                    <div class="current-step-info" id="currentStepInfo"></div>
                </div>

                <div class="tools-panel">
                    <div class="panel-header">🛠️ Coach-Tools</div>
                    <div class="coach-tools" id="coachTools"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Prompt Editor Modal -->
    <div id="promptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>✏️ Prompt für KI-Analyse bearbeiten</h3>
                <button class="close-btn" onclick="closePromptModal()">&times;</button>
            </div>
            
            <div class="screen-share-alert">
                🔴 Bildschirm wird mit Klient geteilt - Gemeinsam Prompt entwickeln
            </div>

            <div class="prompt-editor">
                <label for="promptText">Prompt-Text:</label>
                <textarea id="promptText" placeholder="Hier wird der Prompt für die KI-Analyse erstellt..."></textarea>
            </div>

            <div class="variables-section">
                <h4>Variablen mit Klient anpassen:</h4>
                <div class="variable-input">
                    <label>[PROBLEMBESCHREIBUNG]:</label>
                    <input type="text" id="var1" placeholder="Beschreibung des Hauptproblems...">
                </div>
                <div class="variable-input">
                    <label>[DETAILS]:</label>
                    <input type="text" id="var2" placeholder="Weitere wichtige Details...">
                </div>
                <div class="variable-input">
                    <label>[KONTEXT]:</label>
                    <input type="text" id="var3" placeholder="Situativer Kontext...">
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="sendToKI()">🚀 An KI senden</button>
                <button class="btn btn-secondary" onclick="resetPrompt()">🔄 Zurücksetzen</button>
                <button class="btn btn-secondary" onclick="closePromptModal()">❌ Abbrechen</button>
            </div>

            <div class="loading-indicator" id="loadingIndicator">
                <div class="spinner"></div>
                <p>KI analysiert den Prompt...</p>
            </div>

            <div class="ki-response-section" id="kiResponseSection">
                <div class="ki-response">
                    <div class="ki-response-header">
                        🤖 KI-Analyse Ergebnis:
                    </div>
                    <div class="ki-response-text" id="kiResponseText"></div>
                </div>
                
                <div class="response-actions">
                    <button class="btn btn-primary" onclick="adoptResponse()">✅ Antwort übernehmen</button>
                    <button class="btn btn-secondary" onclick="editResponse()">✏️ Antwort anpassen</button>
                    <button class="btn btn-secondary" onclick="retryPrompt()">🔄 Nochmal versuchen</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let selectedClient = null;
        let currentStep = 1;
        let currentEditingStep = 1;
        let sessionStartTime = null;
        let apiConnected = false;

        // Client Data
        const clients = {
            sarah: {
                name: "Sarah Weber",
                age: "35 Jahre, Marketing-Managerin",
                problem: "Karrierewechsel-Entscheidung zwischen Sicherheit und Nachhaltigkeit",
                background: "10 Jahre Marketing-Erfahrung, träumt von nachhaltiger Arbeit"
            },
            marcus: {
                name: "Marcus Schmidt", 
                age: "48 Jahre, Ingenieur",
                problem: "Midlife-Krise und Wunsch nach beruflicher Neuorientierung",
                background: "20 Jahre in derselben Firma, fühlt sich unterfordert"
            },
            lisa: {
                name: "Dr. Lisa Müller",
                age: "42 Jahre, Ärztin", 
                problem: "Work-Life-Balance als Chirurgin mit Familie",
                background: "Burnout-Symptome, liebt ihren Beruf aber Familie leidet"
            },
            werner: {
                name: "Werner Hoffmann",
                age: "62 Jahre, Abteilungsleiter",
                problem: "Übergang in den Ruhestand und neue Lebenssinn-Findung",
                background: "Jahrzehntelange Führungsrolle, Angst vor Identitätsverlust"
            }
        };

        // 12 Coaching Steps
        const coachingSteps = [
            { id: 1, title: "Ziel & Problem", description: "Klares Coaching-Ziel definieren und Hauptproblem erfassen", prompt: "Als erfahrener Coach-Assistent: Analysiere das Hauptproblem '[PROBLEMBESCHREIBUNG]' mit Kontext '[DETAILS]'. Entwickle präzise Fragen, um ein klares, messbares Coaching-Ziel zu formulieren. Berücksichtige emotionale und praktische Aspekte." },
            { id: 2, title: "IST-Zustand", description: "Aktuelle Situation detailliert erfassen", prompt: "Erfasse den IST-Zustand detailliert. Situation: '[PROBLEMBESCHREIBUNG]'. Details: '[DETAILS]'. Identifiziere Auswirkungen auf verschiedene Lebensbereiche und emotionale Belastungen." },
            { id: 3, title: "SOLL-Zustand", description: "Gewünschte Zukunft konkretisieren", prompt: "Entwickle den SOLL-Zustand für '[PROBLEMBESCHREIBUNG]'. Konkrete Vision: Was würde sich im Alltag ändern? Messbare Erfolgskriterien definieren. Kontext: '[KONTEXT]'." },
            { id: 4, title: "Hindernisse", description: "Blockaden und Widerstände identifizieren", prompt: "Identifiziere systematisch Hindernisse für '[PROBLEMBESCHREIBUNG]'. Interne Blockaden (Ängste, Glaubenssätze) und externe Barrieren. Details: '[DETAILS]'. Priorisiere nach Einfluss." },
            { id: 5, title: "Ressourcen", description: "Vorhandene Stärken und Möglichkeiten erkennen", prompt: "Analysiere verfügbare Ressourcen für '[PROBLEMBESCHREIBUNG]'. Persönliche Stärken, soziales Netzwerk, materielle Ressourcen. Stärken: '[DETAILS]'. Kontext: '[KONTEXT]'." },
            { id: 6, title: "Innere Stimmen", description: "Verschiedene Persönlichkeitsanteile erforschen", prompt: "Identifiziere innere Stimmen/Anteile bei '[PROBLEMBESCHREIBUNG]'. Welcher Anteil ist ängstlich, mutig, rational? Innerer Dialog moderieren. Details: '[DETAILS]'." },
            { id: 7, title: "Optionen", description: "Verschiedene Lösungswege entwickeln", prompt: "Entwickle 4-5 realistische Optionen für '[PROBLEMBESCHREIBUNG]'. Von konservativ bis mutig. Berücksichtige: '[DETAILS]'. Kontext: '[KONTEXT]'. Kreative Alternativen einbeziehen." },
            { id: 8, title: "Bewertung", description: "Vor- und Nachteile der Optionen abwägen", prompt: "Systematische Pro/Contra-Analyse für '[PROBLEMBESCHREIBUNG]'. Bewertungskriterien: Umsetzbarkeit, Risiko, Erfolgschance, Zeitaufwand. Kriterien: '[DETAILS]'." },
            { id: 9, title: "Entscheidung", description: "Beste Option auswählen und begründen", prompt: "Unterstütze Entscheidungsfindung für '[PROBLEMBESCHREIBUNG]'. Welche Option passt zu Werten und Zielen? Bauchgefühl vs. Vernunft. Begründung: '[KONTEXT]'." },
            { id: 10, title: "Maßnahmen", description: "Konkrete Schritte planen", prompt: "Detaillierte Maßnahmenplanung für '[PROBLEMBESCHREIBUNG]'. SMART-Ziele, erste Schritte in 72h. Welche konkreten Aktionen? Timeline: '[DETAILS]'." },
            { id: 11, title: "Timeline", description: "Zeitplan und Meilensteine festlegen", prompt: "Realistische Timeline für '[PROBLEMBESCHREIBUNG]'. Meilensteine, Deadlines, Pufferzeiten. Wann erste Erfolge sichtbar? Rahmen: '[KONTEXT]'." },
            { id: 12, title: "Commitment", description: "Verbindlichkeit und nächste Schritte", prompt: "Stärke das Commitment für '[PROBLEMBESCHREIBUNG]'. Accountability-Partner, Belohnungen, Konsequenzen bei Nichtumsetzung. Nächste 3 Schritte: '[DETAILS]'." }
        ];

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            checkAPIStatus();
            updateTime();
            setInterval(updateTime, 1000);
        });

        function initializeApp() {
            // Client Selection Event Listeners
            const clientCards = document.querySelectorAll('.client-card');
            clientCards.forEach(card => {
                card.addEventListener('click', () => selectClient(card.dataset.client));
            });

            // Start Button Event Listener  
            document.getElementById('startButton').addEventListener('click', startSession);

            // Generate Steps Navigation
            generateStepsNavigation();
        }

        function selectClient(clientId) {
            // Remove previous selection
            document.querySelectorAll('.client-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selection to clicked card
            document.querySelector(`[data-client="${clientId}"]`).classList.add('selected');
            
            selectedClient = clientId;
            
            // Activate start button
            const startButton = document.getElementById('startButton');
            startButton.classList.add('active');
            startButton.textContent = `🚀 Session mit ${clients[clientId].name} starten`;
        }

        function startSession() {
            if (!selectedClient) return;

            sessionStartTime = new Date();
            
            // Hide client selection, show dashboard
            document.getElementById('clientSelection').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            // Update session title
            document.getElementById('sessionTitle').textContent = 
                `Coaching-Session: ${clients[selectedClient].name}`;

            // Initialize chat with welcome message
            addChatMessage('coach', `Hallo ${clients[selectedClient].name}, ich freue mich auf unser Coaching-Gespräch heute. Lassen Sie uns mit Schritt 1 beginnen - der Definition Ihres Coaching-Ziels.`);
            
            setTimeout(() => {
                addChatMessage('client', getClientResponse(1));
            }, 2000);

            // Set current step
            setCurrentStep(1);
        }

        function generateStepsNavigation() {
            const stepsGrid = document.getElementById('stepsGrid');
            stepsGrid.innerHTML = '';

            coachingSteps.forEach(step => {
                const stepButton = document.createElement('div');
                stepButton.className = 'step-button';
                stepButton.dataset.step = step.id;
                stepButton.innerHTML = `<strong>${step.id}</strong><br>${step.title}`;
                stepButton.addEventListener('click', () => setCurrentStep(step.id));
                stepsGrid.appendChild(stepButton);
            });
        }

        function setCurrentStep(stepId) {
            currentStep = stepId;
            
            // Update step buttons
            document.querySelectorAll('.step-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-step="${stepId}"]`).classList.add('active');

            // Update current step info
            const step = coachingSteps.find(s => s.id === stepId);
            updateCurrentStepInfo(step);
            updateCoachTools(step);
        }

        function updateCurrentStepInfo(step) {
            const stepInfo = document.getElementById('currentStepInfo');
            stepInfo.innerHTML = `
                <div class="step-title">Schritt ${step.id}: ${step.title}</div>
                <div class="step-description">${step.description}</div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="editPrompt(${step.id})">✏️ Prompt bearbeiten</button>
                    <button class="btn btn-secondary" onclick="skipStep()">⏭️ Schritt überspringen</button>
                </div>
            `;
        }

        function updateCoachTools(step) {
            const coachTools = document.getElementById('coachTools');
            coachTools.innerHTML = `
                <div class="tool-section">
                    <h4>🎯 Aktueller Fokus</h4>
                    <p>Schritt ${step.id}: ${step.title}</p>
                </div>
                <div class="tool-section">
                    <h4>💡 Coach-Techniken</h4>
                    <button class="btn btn-secondary" style="width:100%; margin-bottom: 8px;" onclick="addCoachNote('Nachfrage')">❓ Nachfragen</button>
                    <button class="btn btn-secondary" style="width:100%; margin-bottom: 8px;" onclick="addCoachNote('Spiegelung')">🪞 Spiegeln</button>
                    <button class="btn btn-secondary" style="width:100%; margin-bottom: 8px;" onclick="addCoachNote('Zusammenfassung')">📝 Zusammenfassen</button>
                </div>
                <div class="tool-section">
                    <h4>📊 Session-Info</h4>
                    <p>Client: ${selectedClient ? clients[selectedClient].name : 'Nicht gewählt'}</p>
                    <p>Dauer: <span id="sessionDuration">00:00</span></p>
                    <p>Schritt: ${step.id}/12</p>
                </div>
            `;
        }

        function editPrompt(stepId) {
            currentEditingStep = stepId;
            const step = coachingSteps.find(s => s.id === stepId);
            
            // Set prompt in modal
            document.getElementById('promptText').value = step.prompt;
            
            // Clear variables
            document.getElementById('var1').value = '';
            document.getElementById('var2').value = '';
            document.getElementById('var3').value = '';
            
            // Hide response section
            document.getElementById('kiResponseSection').classList.remove('show');
            
            // Show modal
            document.getElementById('promptModal').style.display = 'block';
        }

        function closePromptModal() {
            document.getElementById('promptModal').style.display = 'none';
        }

        function resetPrompt() {
            const step = coachingSteps.find(s => s.id === currentEditingStep);
            document.getElementById('promptText').value = step.prompt;
            document.getElementById('var1').value = '';
            document.getElementById('var2').value = '';
            document.getElementById('var3').value = '';
            document.getElementById('kiResponseSection').classList.remove('show');
        }

        async function sendToKI() {
            const promptText = document.getElementById('promptText').value;
            const var1 = document.getElementById('var1').value;
            const var2 = document.getElementById('var2').value;
            const var3 = document.getElementById('var3').value;

            // Replace variables in prompt
            let finalPrompt = promptText
                .replace(/\[PROBLEMBESCHREIBUNG\]/g, var1 || 'Nicht spezifiziert')
                .replace(/\[DETAILS\]/g, var2 || 'Keine weiteren Details')
                .replace(/\[KONTEXT\]/g, var3 || 'Allgemeiner Kontext');

            // Show loading
            document.getElementById('loadingIndicator').classList.add('show');
            document.getElementById('kiResponseSection').classList.remove('show');

            // Try real KI first
            try {
                const timeoutPromise = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('Timeout')), 8000)
                );

                const fetchPromise = fetch('/api/coaching-ai', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: finalPrompt,
                        step: currentEditingStep,
                        client: selectedClient
                    })
                });

                const response = await Promise.race([fetchPromise, timeoutPromise]);
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }

                // Success - show real KI response
                document.getElementById('loadingIndicator').classList.remove('show');
                document.getElementById('kiResponseText').textContent = data.response;
                document.getElementById('kiResponseSection').classList.add('show');
                updateAPIStatus('connected');

            } catch (error) {
                // Fallback to high-quality demo response
                document.getElementById('loadingIndicator').classList.remove('show');
                const fallbackResponse = generateSmartFallbackResponse(currentEditingStep, selectedClient, var1, var2, var3);
                document.getElementById('kiResponseText').textContent = fallbackResponse;
                document.getElementById('kiResponseSection').classList.add('show');
                updateAPIStatus('demo');
                console.log('Using intelligent fallback response:', error.message);
            }
        }

        function generateSmartFallbackResponse(step, client, var1, var2, var3) {
            const clientName = clients[client].name;
            const problem = var1 || clients[client].problem;
            const details = var2 || clients[client].background;
            
            const smartResponses = {
                1: `**Coaching-Ziel für ${clientName} definieren:**

Basierend auf "${problem}" erkenne ich folgende Kernthemen:
• Hauptherausforderung: ${problem}
• Kontext: ${details}

**Präzise Coaching-Fragen:**
1. "Wenn Sie in 6 Monaten zurückblicken - was muss sich konkret verändert haben, damit Sie sagen: 'Das Coaching war erfolgreich'?"
2. "Auf einer Skala von 1-10: Wie klar ist Ihnen aktuell der nächste Schritt?"
3. "Was wäre das Schlimmste, was passieren könnte, wenn Sie nichts ändern?"

**Messbares Ziel:** Eine klare Entscheidung mit konkretem Umsetzungsplan in den nächsten 4 Wochen.`,

                2: `**IST-Zustand Analyse für ${clientName}:**

**Aktuelle Situation:**
• Hauptbelastung: ${problem}
• Hintergrund: ${details}

**Auswirkungen auf verschiedene Lebensbereiche:**
• Beruflich: Unzufriedenheit und fehlende Erfüllung
• Emotional: Innerer Konflikt zwischen Sicherheit und Wachstum
• Sozial: Möglicherweise Spannungen im persönlichen Umfeld
• Gesundheit: Stress durch ungelöste Entscheidung

**Emotionale Bewertung:** Frustration, Ungewissheit, aber auch Hoffnung auf Veränderung.
**Dringlichkeit:** Mittel bis hoch - die Belastung steigt.`,

                3: `**SOLL-Zustand Vision für ${clientName}:**

**Konkrete Zukunftsvision:**
Wenn "${problem}" gelöst wäre, sähe der Alltag so aus:
• Morgens: Motivation und Vorfreude auf den Arbeitstag
• Beruflich: Sinnvolle Tätigkeit, die mit persönlichen Werten übereinstimmt
• Emotional: Innere Ruhe und Selbstvertrauen in Entscheidungen
• Finanziell: Nachhaltige Sicherheit bei erfüllender Arbeit

**Messbare Erfolgskriterien:**
1. Klarheit über berufliche Richtung (bis in 4 Wochen)
2. Konkrete erste Schritte definiert (bis in 6 Wochen)
3. Stress-Level reduziert von aktuell 8/10 auf 4/10
4. Stolz auf getroffene Entscheidung`,

                4: `**Hindernis-Analyse für ${clientName}:**

**Interne Blockaden:**
• Verlustangst: "Was, wenn ich die falsche Entscheidung treffe?"
• Perfektionismus: Warten auf den "perfekten" Moment
• Glaubenssatz: "Sicherheit geht vor Erfüllung"
• Selbstzweifel: "Bin ich gut genug für etwas Neues?"

**Externe Barrieren:**
• Finanzielle Verpflichtungen
• Erwartungen des sozialen Umfelds
• Marktbedingungen im Zielbereich
• Zeitliche Constraints

**Prioritäts-Ranking:**
1. Verlustangst (höchster Einfluss)
2. Finanzielle Sicherheit
3. Selbstzweifel
4. Äußere Erwartungen`,

                5: `**Ressourcen-Inventar für ${clientName}:**

**Persönliche Stärken:**
• 10+ Jahre Berufserfahrung als solide Basis
• Bewusstsein für persönliche Werte (Nachhaltigkeit/Erfüllung)
• Mut, überhaupt eine Veränderung zu erwägen
• Analytische Fähigkeiten für Entscheidungsfindung

**Soziales Netzwerk:**
• Berufliche Kontakte in verschiedenen Branchen
• Familie/Freunde als emotionale Unterstützung
• Potentielle Mentoren im Zielbereich

**Materielle Ressourcen:**
• Finanzielle Rücklagen für Übergangszeit
• Marktgängige Qualifikationen
• Digitale Tools für Networking und Weiterbildung

**Verfügbare Zeit:** ${details.includes('unterfordert') ? 'Freiräume durch Unterforderung' : 'Abends/Wochenenden für Vorbereitung'}`,

                6: `**Innere Stimmen Analyse für ${clientName}:**

**Identifizierte Anteile:**
1. **Der Sicherheits-Wächter:** "Bleib, wo du bist - es ist sicher hier!"
2. **Der Träumer:** "Du könntest so viel mehr erreichen!"
3. **Der Kritiker:** "Andere schaffen das, warum zögerst du?"
4. **Der Weise:** "Welcher Weg führt zu echter Erfüllung?"

**Innerer Dialog:**
Sicherheits-Wächter vs. Träumer: Konstanter Kampf zwischen Risiko und Chance
Der Kritiker verstärkt den Druck, während der Weise nach Balance sucht.

**Moderations-Ansatz:**
- Alle Stimmen anhören und würdigen
- Gemeinsame Werte identifizieren
- Kompromiss-Lösungen entwickeln
- Den Weisen als Mediator stärken`,

                7: `**Lösungsoptionen für ${clientName}:**

**Option 1 - Sanfter Übergang:**
Schrittweise Reduzierung der aktuellen Rolle, parallel Aufbau im Zielbereich
Pro: Geringeres Risiko | Contra: Langsamerer Fortschritt

**Option 2 - Kompletter Wechsel:**
Kündigung und Vollzeit-Einstieg in neuen Bereich
Pro: Schnelle Klarheit | Contra: Höheres finanzielles Risiko

**Option 3 - Sabbatical/Auszeit:**
3-6 Monate Pause zur Orientierung und Weiterbildung
Pro: Zeit für Reflexion | Contra: Einkommensverlust

**Option 4 - Interne Neuorientierung:**
Neue Projekte/Abteilung im aktuellen Unternehmen
Pro: Sicherheit + Veränderung | Contra: Begrenzte Möglichkeiten

**Option 5 - Hybridmodell:**
Teilzeit aktueller Job + Teilzeit neuer Bereich
Pro: Beste aus beiden Welten | Contra: Hohe Arbeitsbelastung`,

                8: `**Pro/Contra Analyse für ${clientName}:**

**Bewertungskriterien gewichtet:**
- Umsetzbarkeit (25%)
- Finanzielles Risiko (30%) 
- Erfüllungspotential (25%)
- Zeitaufwand (20%)

**Option-Bewertung (1-5 Sterne):**

**Sanfter Übergang:** ⭐⭐⭐⭐
+ Machbar und risikoarm
- Dauert länger bis zur Erfüllung

**Kompletter Wechsel:** ⭐⭐⭐
+ Maximale Erfüllung
- Hohes finanzielles Risiko

**Sabbatical:** ⭐⭐⭐⭐
+ Zeit für fundierte Entscheidung
- Temporärer Einkommensverlust

**Empfehlung:** Hybrid aus sanftem Übergang mit geplanter Auszeit zur Weiterbildung`,

                9: `**Entscheidungs-Unterstützung für ${clientName}:**

**Bauchgefühl vs. Vernunft:**
- Bauchgefühl sagt: "${problem.includes('unterfordert') ? 'Zeit für Veränderung!' : 'Erfüllung ist wichtig!'}"
- Vernunft sagt: "Sicherheit nicht leichtfertig aufgeben"

**Werte-Abgleich:**
Die Option "Sanfter Übergang" passt am besten zu Ihren Kernwerten:
• Nachhaltigkeit (auch in der Lebensplanung)
• Verantwortung (für finanzielle Verpflichtungen)
• Wachstum (persönliche Entwicklung)

**Entscheidungs-Impuls:**
"Was würde das 80-jährige Ich Ihnen raten?"
Wahrscheinlich: "Hab Mut, aber sei klug dabei."

**Empfehlung:** Starten Sie in den nächsten 2 Wochen mit der Vorbereitung für den sanften Übergang.`,

                10: `**Maßnahmenplan für ${clientName}:**

**72-Stunden-Aktionen:**
1. Finanzcheck: Wie lange können Sie ohne aktuelles Gehalt leben?
2. Netzwerk aktivieren: 3 Kontakte im Zielbereich kontaktieren
3. Skill-Gap-Analyse: Welche Qualifikationen fehlen noch?

**SMART-Ziele (nächste 4 Wochen):**
- **S**pezifisch: 10 informative Gespräche mit Profis im Zielbereich
- **M**essbar: Bewerbungsunterlagen für neue Richtung erstellen
- **A**ttraktiv: Vision Board für neuen Lebensabschnitt
- **R**ealistisch: Parallele Weiterbildung starten
- **T**erminiert: Bis [Datum in 4 Wochen]

**Erste konkrete Schritte:**
1. LinkedIn-Profil aktualisieren
2. Branchenveranstaltungen recherchieren
3. Finanzberater Termin vereinbaren`,

                11: `**Timeline für ${clientName}:**

**Phase 1 (Woche 1-4): Vorbereitung**
- Netzwerk aktivieren und informative Gespräche
- Skill-Assessment und Weiterbildungsplan
- Finanzielle Planung

**Phase 2 (Woche 5-12): Orientierung**
- Praktika/Hospitationen im Zielbereich
- Erste Bewerbungen/Sondierungen
- Reduzierung aktueller Belastung

**Phase 3 (Woche 13-26): Übergang**
- Konkrete Angebote evaluieren
- Verhandlungen mit aktuellem AG
- Schrittweise Übergabe

**Meilensteine:**
✓ Woche 2: Klarheit über Zielbereich
✓ Woche 6: Erste konkrete Kontakte
✓ Woche 12: Machbare Option identifiziert
✓ Woche 20: Entscheidung getroffen
✓ Woche 26: Übergang vollzogen

**Pufferzeiten:** +2 Wochen pro Phase für unvorhergesehene Ereignisse`,

                12: `**Commitment-Stärkung für ${clientName}:**

**Accountability-System:**
- **Partner:** Vertraute Person als wöchentlicher Check-in
- **Coach:** Monatliche Zwischenreflexion
- **Selbst:** Tägliches 5-Minuten-Journal zum Fortschritt

**Belohnungen bei Meilenstei-Erreichung:**
• Woche 4: Besonderes Dinner in Lieblingsrestaurant
• Woche 12: Wellness-Wochenende
• Woche 26: Kurzurlaub zur Feier des Übergangs

**Konsequenzen bei Stillstand:**
- Nach 2 Wochen ohne Fortschritt: Ehrliche Reflexion mit Accountability-Partner
- Öffentliches Commitment (Familie/Freunde informieren)
- Professionelle Coaching-Unterstützung intensivieren

**Nächste 3 konkrete Schritte:**
1. **Heute:** Accountability-Partner bestimmen und kontaktieren
2. **Diese Woche:** Ersten informativen Gesprächstermin vereinbaren  
3. **Bis Ende Monat:** Detaillierteren Finanzplan erstellen

**Commitment-Satz:** "Ich verpflichte mich, in den nächsten 6 Monaten konkrete Schritte für meine berufliche Erfüllung zu gehen, auch wenn es bedeutet, meine Komfortzone zu verlassen."`
            };
            
            return smartResponses[step] || `**Professionelle Coaching-Analyse - Schritt ${step}**

Für ${clientName} mit der Herausforderung "${problem}" empfehle ich:

${step <= 4 ? 'In dieser Analysephase' : step <= 8 ? 'In dieser Entwicklungsphase' : 'In dieser Umsetzungsphase'} ist es wichtig, systematisch vorzugehen. 

Basierend auf den Angaben "${details}" sehe ich folgende Schwerpunkte:
• Strukturierte Herangehensweise an die Problemstellung
• Berücksichtigung emotionaler und praktischer Aspekte  
• Entwicklung konkreter, umsetzbarer Lösungsschritte

**Nächste Schritte:** Vertiefen Sie die Reflexion mit gezielten Fragen und entwickeln Sie gemeinsam mit Ihrem Klienten praktikable Ansätze.

*Diese Demo-Antwort zeigt die Art der KI-Unterstützung. In der Live-Version würden hier noch detailliertere, personalisierte Analysen erscheinen.*`;
        }

        function adoptResponse() {
            const response = document.getElementById('kiResponseText').textContent;
            addChatMessage('ai', response);
            closePromptModal();
            
            // Auto-proceed to next step after a delay
            setTimeout(() => {
                if (currentStep < 12) {
                    setCurrentStep(currentStep + 1);
                }
            }, 1000);
        }

        function editResponse() {
            // Allow editing of the response
            const responseDiv = document.getElementById('kiResponseText');
            const currentText = responseDiv.textContent;
            responseDiv.innerHTML = `<textarea style="width:100%; height:200px; padding:15px; border: 2px solid #667eea; border-radius:10px; font-family:inherit; line-height:1.6;">${currentText}</textarea>`;
        }

        function retryPrompt() {
            sendToKI();
        }

        function addChatMessage(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const timestamp = new Date().toLocaleTimeString('de-DE', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            messageDiv.innerHTML = `
                <div class="timestamp">${timestamp}</div>
                <div class="text">${message}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Show typing indicator for client responses
            if (sender === 'coach') {
                setTimeout(() => {
                    showTypingIndicator();
                }, 1000);
            }
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').classList.add('show');
            setTimeout(() => {
                document.getElementById('typingIndicator').classList.remove('show');
            }, 2000);
        }

        function getClientResponse(step) {
            const responses = {
                sarah: {
                    1: "Ja, das ist genau mein Problem. Ich bin wirklich unsicher, ob ich den Wechsel in den nachhaltigen Sektor wagen soll. Einerseits habe ich eine sichere Position, andererseits fühle ich mich nicht mehr erfüllt und möchte etwas Sinnvolles machen.",
                    2: "Aktuell bin ich Marketing-Managerin in einem großen Konzern. Das Gehalt ist gut, aber ich arbeite für Produkte, hinter denen ich nicht wirklich stehe. Das belastet mich zunehmend und ich merke, dass ich immer unzufriedener werde."
                },
                marcus: {
                    1: "Ich fühle mich seit Monaten unzufrieden und irgendwie gefangen. 20 Jahre in derselben Firma - das war mal mein Traumjob, aber jetzt langweile ich mich und sehe keine Perspektive mehr für mich.",
                    2: "Meine Aufgaben sind Routine geworden. Ich mache sie mit links, aber dabei fühle ich mich leer und unterfordert. Gleichzeitig habe ich Angst, in meinem Alter nochmal von vorne anzufangen."
                },
                lisa: {
                    1: "Die Balance zwischen Karriere und Familie wird immer schwieriger. Ich liebe meinen Beruf als Chirurgin, aber die Familie leidet darunter