<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triadisches Coaching Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.1em;
            color: #666;
            max-width: 800px;
            margin: 0 auto 20px;
            line-height: 1.6;
        }

        .demo-notice {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 15px 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #e17055;
        }

        .demo-notice h3 {
            color: #d63031;
            margin-bottom: 10px;
        }

        .demo-notice p {
            color: #2d3436;
            margin-bottom: 8px;
        }

        .api-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: bold;
            z-index: 1000;
            background: #e74c3c;
            color: white;
        }

        .api-status.connected {
            background: #27ae60;
        }

        .client-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .client-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .client-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .client-card.selected {
            border-color: #667eea !important;
            background: rgba(102, 126, 234, 0.1) !important;
            transform: translateY(-3px) !important;
        }

        .client-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .client-card .age {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .client-card .challenge {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 500;
            color: #d63031;
        }

        .client-card .background {
            color: #666;
            line-height: 1.5;
            font-size: 0.95em;
        }

        .start-button {
            background: rgba(108, 117, 125, 0.3);
            color: rgba(108, 117, 125, 0.7);
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: not-allowed;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            font-weight: bold;
            opacity: 0.5;
        }

        .start-button.active {
            background: linear-gradient(135deg, #27ae60, #2ecc71) !important;
            color: white !important;
            cursor: pointer !important;
            opacity: 1 !important;
            transform: scale(1.05) !important;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3) !important;
        }

        .start-button:hover.active {
            transform: scale(1.08) !important;
        }

        .dashboard {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .client-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .client-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            color: white;
        }

        .session-controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .coaching-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .step {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #ddd;
        }

        .step:hover {
            background: rgba(102, 126, 234, 0.1);
            border-left-color: #667eea;
            transform: translateX(5px);
        }

        .step.active {
            background: rgba(102, 126, 234, 0.15);
            border-left-color: #667eea;
        }

        .step h4 {
            color: #667eea;
            margin-bottom: 8px;
        }

        .step p {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .coach-tools {
            background: rgba(255, 248, 220, 0.9);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 4px solid #f39c12;
        }

        .coach-tools h4 {
            color: #d68910;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .tool-item {
            background: rgba(243, 156, 18, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            color: #d68910;
            font-weight: 500;
        }

        .chat-interface {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .chat-main {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 25px;
            min-height: 400px;
        }

        .chat-sidebar {
            background: rgba(255, 248, 220, 0.9);
            border-radius: 15px;
            padding: 25px;
            border-left: 4px solid #f39c12;
        }

        .chat-messages {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(248, 249, 250, 0.8);
            border-radius: 10px;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 15px;
            border-radius: 10px;
            max-width: 80%;
        }

        .message.user {
            background: #667eea;
            color: white;
            margin-left: auto;
        }

        .message.ai {
            background: rgba(39, 174, 96, 0.1);
            border: 1px solid #27ae60;
            color: #27ae60;
        }

        .message.coach {
            background: rgba(243, 156, 18, 0.1);
            border: 1px solid #f39c12;
            color: #d68910;
        }

        .typing-indicator {
            display: none;
            color: #888;
            font-style: italic;
            margin-bottom: 15px;
        }

        .typing-indicator.show {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group textarea,
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            transition: border-color 0.3s ease;
            resize: vertical;
        }

        .form-group textarea:focus,
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .variable-inputs {
            background: rgba(102, 126, 234, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .variable-inputs h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .ai-response {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid #27ae60;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            min-height: 100px;
        }

        .ai-response h4 {
            color: #27ae60;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-response-content {
            color: #333;
            line-height: 1.6;
            font-size: 1.05em;
        }

        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            font-style: italic;
            margin: 20px 0;
        }

        .loading.show {
            display: block;
        }

        .screen-sharing-notice {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .session-timer {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        .timer-display {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .client-selection {
                grid-template-columns: 1fr;
            }

            .coaching-steps {
                grid-template-columns: 1fr;
            }

            .chat-interface {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }

            .dashboard-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }

        .debug-info {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #ff0000;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.9em;
            color: #cc0000;
        }
    </style>
</head>
<body>
    <div id="apiStatus" class="api-status">üî¥ API Status: Nicht verbunden</div>
    
    <div class="container">
        <div class="header">
            <h1>ü§ñ Triadisches Coaching Demo</h1>
            <p>Erleben Sie innovative KI-unterst√ºtzte Coaching-Sessions mit dem revolution√§ren Coach + Klient + KI System</p>
            
            <div class="demo-notice">
                <h3>üí° Wichtiger Hinweis zum echten Coaching-Prozess:</h3>
                <p><strong>üó£Ô∏è Live-Coaching l√§uft m√ºndlich ab:</strong> Echte Coaching-Sessions finden √ºber Zoom oder pers√∂nlich statt. Der Coach f√ºhrt ein normales Gespr√§ch mit dem Klienten.</p>
                <p><strong>ü§ñ KI-Integration im Hintergrund:</strong> W√§hrend des Gespr√§chs fasst der Coach wichtige Aussagen des Klienten in Prompts zusammen und sendet diese an die KI. Beide betrachten die KI-Antwort gemeinsam am geteilten Bildschirm.</p>
                <p><strong>üë• Kollaborativer Prozess:</strong> Klient und Coach diskutieren die KI-Hinweise gemeinsam und passen diese bei Bedarf an - echte Teamarbeit zu dritt!</p>
                <p><strong>üì∫ Diese Demo zeigt:</strong> Den beispielhaften Workflow und die praktische KI-Integration, die das Live-Coaching so kraftvoll macht.</p>
            </div>
        </div>

        <!-- Klient-Auswahl -->
        <div id="clientSelection">
            <h2 style="text-align: center; margin-bottom: 30px; color: white;">W√§hlen Sie einen Klienten f√ºr die Demo-Session:</h2>
            
            <div class="client-selection">
                <div class="client-card" data-client="sarah" onclick="selectClient('sarah')">
                    <h3>Sarah Weber</h3>
                    <div class="age">35 Jahre ‚Ä¢ Karrierewechsel</div>
                    <div class="challenge">üéØ Berufliche Neuorientierung nach 10 Jahren im Marketing</div>
                    <div class="background">
                        Sarah ist eine erfahrene Marketing-Managerin, die sich nach einem erf√ºllenderem Beruf sehnt. 
                        Sie m√∂chte in den Bereich Nachhaltigkeit wechseln, ist aber unsicher √ºber die praktischen Schritte 
                        und hat Angst vor finanziellen Einbu√üen. Sie sucht nach Klarheit √ºber ihre wahren St√§rken und 
                        einem realistischen √úbergangsplan.
                    </div>
                </div>

                <div class="client-card" data-client="marcus" onclick="selectClient('marcus')">
                    <h3>Marcus Hoffmann</h3>
                    <div class="age">48 Jahre ‚Ä¢ Midlife-Crisis</div>
                    <div class="challenge">üîÑ Sinnkrise und Zweifel an bisherigen Lebensentscheidungen</div>
                    <div class="background">
                        Marcus ist ein erfolgreicher Ingenieur, der trotz √§u√üerem Erfolg eine tiefe Unzufriedenheit 
                        versp√ºrt. Er hinterfragt seine Karriere, seine Ehe und seine Lebensziele. Die Kinder sind 
                        ausgezogen und er fragt sich "War das schon alles?". Er sucht nach neuem Sinn und 
                        Lebensfreude in der zweiten Lebensh√§lfte.
                    </div>
                </div>

                <div class="client-card" data-client="lisa" onclick="selectClient('lisa')">
                    <h3>Lisa M√ºller</h3>
                    <div class="age">42 Jahre ‚Ä¢ Work-Life-Balance</div>
                    <div class="challenge">‚öñÔ∏è √úberforderung zwischen Karriere als Chirurgin und Familienleben</div>
                    <div class="background">
                        Lisa ist eine leidenschaftliche Chirurgin mit zwei Kindern. Sie arbeitet 60-70 Stunden pro Woche 
                        und sieht ihre Kinder nur abends kurz. Sie liebt ihren Beruf, aber die Familie leidet darunter. 
                        Erste Burnout-Symptome machen sich bemerkbar. Sie sucht nach Wegen, beiden Lebensbereichen 
                        gerecht zu werden, ohne einen davon aufgeben zu m√ºssen.
                    </div>
                </div>

                <div class="client-card" data-client="werner" onclick="selectClient('werner')">
                    <h3>Werner Schmidt</h3>
                    <div class="age">63 Jahre ‚Ä¢ Ruhestand</div>
                    <div class="challenge">üé≠ Angst vor dem Ruhestand und Verlust der beruflichen Identit√§t</div>
                    <div class="background">
                        Werner war 40 Jahre lang ein respektierter Abteilungsleiter in einem Maschinenbauunternehmen. 
                        In zwei Jahren geht er in Rente und hat gro√üe √Ñngste vor dieser Lebensphase. "Wer bin ich ohne 
                        meinen Beruf?" ist seine zentrale Frage. Er braucht Unterst√ºtzung beim √úbergang und der 
                        Entwicklung einer neuen, erf√ºllenden Lebensphase.
                    </div>
                </div>
            </div>

            <button id="startButton" class="start-button" onclick="startSession()">
                üöÄ Klient ausw√§hlen
            </button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-header">
                <div class="client-info">
                    <div id="clientAvatar" class="client-avatar">SW</div>
                    <div>
                        <h2 id="clientName">Sarah Weber</h2>
                        <p id="clientChallenge" style="color: #666;">Karrierewechsel ‚Ä¢ 35 Jahre</p>
                    </div>
                </div>
                <div class="session-controls">
                    <button class="btn btn-secondary" onclick="shareScreen()">üì∫ Bildschirm teilen</button>
                    <button class="btn btn-primary" onclick="exportSession()">üíæ Session exportieren</button>
                    <button class="btn btn-secondary" onclick="endSession()">‚ùå Session beenden</button>
                </div>
            </div>

            <div class="session-timer">
                <div class="timer-display" id="sessionTimer">00:00</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="coaching-steps">
                <div class="step" data-step="1" onclick="selectStep(1)">
                    <h4>1. Zieldefinition</h4>
                    <p>Klares, messbares Coaching-Ziel gemeinsam entwickeln</p>
                </div>
                <div class="step" data-step="2" onclick="selectStep(2)">
                    <h4>2. Situationsanalyse</h4>
                    <p>Aktuelle Situation und Herausforderungen erfassen</p>
                </div>
                <div class="step" data-step="3" onclick="selectStep(3)">
                    <h4>3. Vision entwickeln</h4>
                    <p>Kraftvolle Zukunftsvision als Orientierung schaffen</p>
                </div>
                <div class="step" data-step="4" onclick="selectStep(4)">
                    <h4>4. Hindernisse identifizieren</h4>
                    <p>Innere und √§u√üere Blockaden bewusst machen</p>
                </div>
                <div class="step" data-step="5" onclick="selectStep(5)">
                    <h4>5. Ressourcen aktivieren</h4>
                    <p>St√§rken, F√§higkeiten und Unterst√ºtzung mobilisieren</p>
                </div>
                <div class="step" data-step="6" onclick="selectStep(6)">
                    <h4>6. Innere Anteile</h4>
                    <p>Verschiedene Pers√∂nlichkeitsaspekte integrieren</p>
                </div>
                <div class="step" data-step="7" onclick="selectStep(7)">
                    <h4>7. L√∂sungsstrategien</h4>
                    <p>Konkrete Handlungsoptionen entwickeln</p>
                </div>
                <div class="step" data-step="8" onclick="selectStep(8)">
                    <h4>8. Entscheidungsfindung</h4>
                    <p>Beste L√∂sung ausw√§hlen und priorisieren</p>
                </div>
                <div class="step" data-step="9" onclick="selectStep(9)">
                    <h4>9. Ma√ünahmenplanung</h4>
                    <p>Detaillierte Schritte und Timeline festlegen</p>
                </div>
                <div class="step" data-step="10" onclick="selectStep(10)">
                    <h4>10. Erfolgsmetriken</h4>
                    <p>Messbare Indikatoren f√ºr Fortschritt definieren</p>
                </div>
                <div class="step" data-step="11" onclick="selectStep(11)">
                    <h4>11. Risikomanagement</h4>
                    <p>M√∂gliche Hindernisse antizipieren und Gegenma√ünahmen</p>
                </div>
                <div class="step" data-step="12" onclick="selectStep(12)">
                    <h4>12. Commitment</h4>
                    <p>Verbindliche Vereinbarungen und n√§chste Schritte</p>
                </div>
            </div>

            <div id="coachTools" class="coach-tools">
                <h4>üõ†Ô∏è Coach-Techniken f√ºr aktuellen Schritt</h4>
                <div id="currentTools" class="tool-grid">
                    <div class="tool-item">Zirkul√§re Fragen</div>
                    <div class="tool-item">Externalisierung</div>
                    <div class="tool-item">Zielcollage</div>
                </div>
                <button class="btn btn-primary" style="margin-top: 15px;" onclick="openPromptEditor()">
                    ‚úèÔ∏è Prompt bearbeiten
                </button>
            </div>

            <div class="chat-interface">
                <div class="chat-main">
                    <h3 style="margin-bottom: 20px; color: #667eea;">üí¨ Beispielhafter Dialog</h3>
                    <div id="chatMessages" class="chat-messages">
                        <div class="message coach">
                            <strong>Coach:</strong> Willkommen zur heutigen Session! Wie geht es Ihnen heute?
                        </div>
                    </div>
                    <div id="typingIndicator" class="typing-indicator">
                        KI analysiert und gibt Impulse...
                    </div>
                </div>

                <div class="chat-sidebar">
                    <h4 style="color: #d68910; margin-bottom: 15px;">üéØ KI-Coach Hinweise</h4>
                    <div id="coachInstructions" style="color: #d68910; line-height: 1.6;">
                        <p><strong>Aktuelle Phase:</strong> Beziehungsaufbau und Vertrauen schaffen</p>
                        <p><strong>Empfehlung:</strong> Aktives Zuh√∂ren, Empathie zeigen, offene Fragen stellen</p>
                        <p><strong>Achtung:</strong> Nicht zu schnell in L√∂sungen gehen, erstmal verstehen</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Prompt Editor Modal -->
    <div id="promptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è KI-Prompt Bearbeitung - Kollaborativ mit Klient</h2>
                <span class="close" onclick="closePromptEditor()">&times;</span>
            </div>
            
            <div class="screen-sharing-notice">
                üì∫ Screen-Sharing aktiv: Klient sieht dieses Fenster mit!
            </div>

            <div class="form-group">
                <label for="promptText">Prompt f√ºr KI-Assistent:</label>
                <textarea id="promptText" rows="4" placeholder="Beschreiben Sie, was die KI analysieren soll...">Als erfahrener Coach-Assistent: Analysiere das Hauptproblem '[PROBLEMBESCHREIBUNG]' mit Kontext '[DETAILS]'. Entwickle pr√§zise Fragen, um ein klares, messbares Coaching-Ziel zu formulieren. Ber√ºcksichtige emotionale und praktische Aspekte.</textarea>
            </div>

            <div class="variable-inputs">
                <h4>üîß Variablen aus dem Live-Coaching:</h4>
                <div class="form-group">
                    <label for="problemDescription">[PROBLEMBESCHREIBUNG]:</label>
                    <input type="text" id="problemDescription" placeholder="Was beschreibt der Klient als Hauptproblem?">
                </div>
                <div class="form-group">
                    <label for="details">[DETAILS]:</label>
                    <input type="text" id="details" placeholder="Welche Details und Kontext-Infos gibt der Klient?">
                </div>
                <div class="form-group">
                    <label for="context">[KONTEXT]:</label>
                    <input type="text" id="context" placeholder="Weitere wichtige Rahmenbedingungen?">
                </div>
            </div>

            <div class="loading" id="promptLoading">
                ü§ñ KI analysiert die Situation...
            </div>

            <div class="ai-response" id="aiResponse" style="display: none;">
                <h4>ü§ñ KI-Response f√ºr Klient:</h4>
                <div id="aiResponseContent" class="ai-response-content">
                    Hier erscheint die KI-Antwort...
                </div>
            </div>

            <div style="text-align: center; margin-top: 25px;">
                <button class="btn btn-primary" onclick="sendToAI()" style="font-size: 1.1em; padding: 12px 30px;">
                    üöÄ An KI senden
                </button>
                <button class="btn btn-secondary" onclick="closePromptEditor()" style="margin-left: 15px;">
                    Schlie√üen
                </button>
            </div>
        </div>
    </div>

    <script>
        let selectedClient = null;
        let currentStep = 1;
        let sessionStartTime = null;
        let sessionTimer = null;

        // Debug-Logging
        console.log('Initializing app...');

        const clients = {
            sarah: {
                name: "Sarah Weber",
                age: "35 Jahre",
                challenge: "Karrierewechsel",
                background: "Erfahrene Marketing-Managerin, die sich nach einem erf√ºllenderem Beruf im Bereich Nachhaltigkeit sehnt.",
                avatar: "SW"
            },
            marcus: {
                name: "Marcus Hoffmann", 
                age: "48 Jahre",
                challenge: "Midlife-Crisis",
                background: "Erfolgreicher Ingenieur mit tiefer Unzufriedenheit trotz √§u√üerem Erfolg.",
                avatar: "MH"
            },
            lisa: {
                name: "Lisa M√ºller",
                age: "42 Jahre", 
                challenge: "Work-Life-Balance",
                background: "Leidenschaftliche Chirurgin mit Kindern, die zwischen Karriere und Familie balanciert.",
                avatar: "LM"
            },
            werner: {
                name: "Werner Schmidt",
                age: "63 Jahre",
                challenge: "Ruhestand",
                background: "Langj√§hriger Abteilungsleiter mit Angst vor dem Ruhestand und Verlust der beruflichen Identit√§t.",
                avatar: "WS"
            }
        };

        const stepTools = {
            1: [
                "Zirkul√§re Fragen", "Externalisierung", "Zielcollage", 
                "SMART-Kriterien", "Werte-Kl√§rung", "Vision Board",
                "Ressourcen-Exploration", "Erste Erfolgs-Anker"
            ],
            2: [
                "Aktives Spiegeln", "Gef√ºhls-Landkarte", "Lebensrad", 
                "Systemische Fragen", "Problem-Externalisierung", "Timeline-Arbeit"
            ],
            3: [
                "Wunderfrage", "Zukunftsvision", "Visions-Board",
                "Best-Case-Scenario", "Idealer Tag", "Wertekompass"
            ],
            4: [
                "Hindernis-Analyse", "Glaubenssatz-Check", "Saboteur-Identifikation",
                "Systemische Hindernisse", "Angst-Exploration", "Blockaden-Mapping"
            ],
            5: [
                "St√§rken-Inventur", "Erfolgsgeschichten", "Energie-Quellen",
                "Ressourcen-Einsatz", "Potentiale aktivieren", "Bew√§ltigungsstrategien",
                "Unterst√ºtzungsnetzwerk", "√úberwindungsstrategien"
            ],
            6: [
                "Innere Anteile", "Avatar-Interview", "Rollenwechsel",
                "Zukunfts-Ich Dialog", "Innerer Kritiker", "Weiser Ratgeber",
                "Systemische Anteile", "Famili√§re Stimmen"
            ],
            7: [
                "Brainstorming", "Pro-Contra-Liste", "Optionen-Matrix",
                "Kreative L√∂sungsfindung", "Alternative Wege", "Out-of-the-box"
            ],
            8: [
                "Entscheidungsmatrix", "Kopf-Bauch-Check", "Pro-Contra Plus",
                "Werte-Abgleich", "Konsequenz-Analyse", "Intuitions-Check"
            ],
            9: [
                "SMART-Ziele", "Meilenstein-Planung", "Aktionsplan",
                "Bauchgef√ºhl-Check", "Weiser Ratgeber", "Entscheidungs-Ritual",
                "Timeline", "Ressourcen-Planung", "Erfolgsindikatoren"
            ],
            10: [
                "KPI-Definition", "Messbare Indikatoren", "Erfolgs-Tracking",
                "Fortschritts-Monitoring", "Feedback-Schleifen", "Anpassungszyklen"
            ],
            11: [
                "Risiko-Matrix", "Worst-Case-Analyse", "Plan B entwickeln", 
                "Pr√§ventivma√ünahmen", "Notfallpl√§ne", "Flexibilit√§ts-Puffer"
            ],
            12: [
                "Commitment-Ritual", "Verbindlichkeit schaffen", "Accountability-Partner",
                "Follow-up-Termine", "Erfolgskontrolle", "Nachhaltigkeit sichern"
            ]
        };

        function selectClient(clientId) {
            console.log(`Client card clicked: ${clientId}`);
            selectedClient = clientId;
            console.log(`Selecting client: ${clientId}`);
            
            const availableClients = Object.keys(clients);
            console.log(`Available clients:`, availableClients);
            
            const clientData = clients[clientId];
            console.log(`Client data:`, clientData);
            
            // Entferne active Klasse von allen Karten
            const allCards = document.querySelectorAll('.client-card');
            console.log(`Found cards for deselection:`, allCards.length);
            allCards.forEach(card => card.classList.remove('selected'));
            
            // F√ºge active Klasse zur gew√§hlten Karte hinzu
            const selectedCard = document.querySelector(`[data-client="${clientId}"]`);
            console.log(`Found selected card:`, selectedCard);
            
            if (selectedCard) {
                selectedCard.classList.add('selected');
                console.log(`Client card selected: ${clientId}`);
            }
            
            // Globale Variable setzen
            window.selectedClient = clientId;
            console.log(`Global selectedClient set to:`, window.selectedClient);
            
            // Start-Button aktivieren
            const startButton = document.getElementById('startButton');
            console.log(`Found start button:`, startButton);
            
            if (startButton && clientData) {
                startButton.textContent = `üöÄ Session mit ${clientData.name} starten`;
                startButton.classList.add('active');
                startButton.disabled = false;
                console.log(`Start button activated with text: ${startButton.textContent}`);
                console.log(`Start button classes:`, startButton.className);
            } else {
                console.error(`Start button or client data not found!`);
            }
        }

        function startSession() {
            console.log('Starting session...');
            if (!selectedClient) {
                console.error('No client selected!');
                alert('Bitte w√§hlen Sie zuerst einen Klienten aus.');
                return;
            }

            console.log(`Starting session for client: ${selectedClient}`);
            
            const clientData = clients[selectedClient];
            
            // UI umschalten
            document.getElementById('clientSelection').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            // Client-Daten im Dashboard setzen
            document.getElementById('clientAvatar').textContent = clientData.avatar;
            document.getElementById('clientName').textContent = clientData.name;
            document.getElementById('clientChallenge').textContent = `${clientData.challenge} ‚Ä¢ ${clientData.age}`;
            
            // Session-Timer starten
            sessionStartTime = Date.now();
            startSessionTimer();
            
            // Ersten Schritt aktivieren
            selectStep(1);
            
            console.log('Session started successfully!');
        }

        function selectStep(stepNum) {
            currentStep = stepNum;
            
            // Schritt-Hervorhebung
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.querySelector(`[data-step="${stepNum}"]`).classList.add('active');
            
            // Tools f√ºr aktuellen Schritt aktualisieren
            updateCoachTools(stepNum);
            
            // Progress aktualisieren
            updateProgress(stepNum);
        }

        function updateCoachTools(stepNum) {
            const tools = stepTools[stepNum] || ["Allgemeine Coaching-Techniken"];
            const toolsContainer = document.getElementById('currentTools');
            
            toolsContainer.innerHTML = tools.map(tool => 
                `<div class="tool-item">${tool}</div>`
            ).join('');
        }

        function updateProgress(stepNum) {
            const progress = (stepNum / 12) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        function startSessionTimer() {
            sessionTimer = setInterval(() => {
                const elapsed = Date.now() - sessionStartTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('sessionTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function openPromptEditor() {
            document.getElementById('promptModal').style.display = 'block';
            
            // Beispiel-Daten setzen basierend auf Klient
            const clientData = clients[selectedClient];
            if (selectedClient === 'lisa') {
                document.getElementById('problemDescription').value = "Die Balance zwischen Karriere als Chirurgin und Familie wird immer schwieriger";
                document.getElementById('details').value = "60-70 Stunden Wochen, Kinder sehe ich nur abends kurz";
                document.getElementById('context').value = "Liebe meinen Beruf, will ihn nicht aufgeben, aber Familie leidet";
            }
        }

        function closePromptEditor() {
            document.getElementById('promptModal').style.display = 'none';
            document.getElementById('aiResponse').style.display = 'none';
            document.getElementById('promptLoading').classList.remove('show');
        }

        async function sendToAI() {
            console.log('Sending to AI...');
            
            const promptText = document.getElementById('promptText').value;
            const problemDescription = document.getElementById('problemDescription').value;
            const details = document.getElementById('details').value;
            const context = document.getElementById('context').value;
            
            // Loading anzeigen
            document.getElementById('promptLoading').classList.add('show');
            document.getElementById('aiResponse').style.display = 'none';
            
            // API Status aktualisieren
            document.getElementById('apiStatus').textContent = 'üü° API Status: Verbinde...';
            
            try {
                const response = await fetch('/api/coaching-ai', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: promptText,
                        step: currentStep,
                        client: selectedClient,
                        variables: {
                            PROBLEMBESCHREIBUNG: problemDescription,
                            DETAILS: details,
                            KONTEXT: context
                        }
                    }),
                });

                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('apiStatus').textContent = 'üü¢ API Status: OpenAI verbunden';
                    document.getElementById('apiStatus').classList.add('connected');
                    
                    // Echte AI Response anzeigen
                    document.getElementById('aiResponseContent').innerHTML = data.response;
                } else {
                    throw new Error(`API Error: ${response.status}`);
                }
            } catch (error) {
                console.error('AI API Error:', error);
                document.getElementById('apiStatus').textContent = 'üî¥ API Status: Fallback aktiv';
                
                // Intelligente Fallback-Response
                const clientData = clients[selectedClient];
                const fallbackResponse = generateIntelligentFallback(clientData, problemDescription, details, context);
                document.getElementById('aiResponseContent').innerHTML = fallbackResponse;
            }
            
            // Loading verstecken, Response zeigen
            document.getElementById('promptLoading').classList.remove('show');
            document.getElementById('aiResponse').style.display = 'block';
        }

        function generateIntelligentFallback(clientData, problem, details, context) {
            const responses = {
                sarah: `
                    <p><strong>Liebe Frau Weber,</strong></p>
                    <p>vielen Dank f√ºr Ihr Vertrauen, diese wichtigen Gedanken zu teilen. Ich h√∂re aus Ihren Worten eine klare Sehnsucht nach mehr Sinnhaftigkeit in Ihrer Arbeit - das zeigt Ihre Weitsicht und Ihren Mut zur Ver√§nderung.</p>
                    <p><strong>Ihre St√§rken, die ich erkenne:</strong> 10 Jahre Marketing-Erfahrung sind ein enormer Schatz! Sie haben bewiesen, dass Sie Projekte erfolgreich leiten k√∂nnen, und Ihr Wunsch nach Nachhaltigkeit zeigt Ihre Zukunftsorientierung.</p>
                    <p><strong>Erste Fragen zum Erkunden:</strong> Was genau zieht Sie am Nachhaltigkeitsbereich am meisten an? Welche Ihrer Marketing-F√§higkeiten k√∂nnten in diesem Bereich besonders wertvoll sein?</p>
                `,
                lisa: `
                    <p><strong>Liebe Frau M√ºller,</strong></p>
                    <p>ich sp√ºre Ihre Leidenschaft sowohl f√ºr Ihren Beruf als auch f√ºr Ihre Familie - das ist ein Geschenk, auch wenn es sich gerade wie eine Last anf√ºhlt. Ihre Sorge zeigt, wie wichtig Ihnen beide Lebensbereiche sind.</p>
                    <p><strong>Ihre besonderen St√§rken:</strong> Sie haben bereits bewiesen, dass Sie in extremen Stresssituationen Leben retten k√∂nnen. Diese Entscheidungskraft und Priorit√§tensetzung sind Superkr√§fte, die wir auch f√ºr Ihr Privatleben nutzen k√∂nnen.</p>
                    <p><strong>Zum Nachdenken:</strong> Wenn Sie Ihre chirurgischen F√§higkeiten der Priorit√§tensetzung auf Ihr Familienleben anwenden w√ºrden - welche 2-3 Momente mit Ihren Kindern w√§ren t√§glich "lebensrettend" wichtig?</p>
                `,
                marcus: `
                    <p><strong>Lieber Herr Hoffmann,</strong></p>
                    <p>Ihre Frage "War das schon alles?" ist nicht ein Zeichen von Undankbarkeit, sondern von Lebensdurst - das ist wundervoll! Mit 48 haben Sie noch Jahrzehnte voller M√∂glichkeiten vor sich.</p>
                    <p><strong>Was ich an Ihnen sch√§tze:</strong> Sie haben die Ehrlichkeit, sich selbst kritisch zu hinterfragen. Ihre Ingenieurs-Denkweise kann Ihnen helfen, Ihr Leben wie ein spannendes Projekt neu zu "konstruieren".</p>
                    <p><strong>Erste Reflexion:</strong> Wenn Sie auf 80 zur√ºckblicken w√ºrden - worauf w√§ren Sie dann stolz, es in den n√§chsten 10 Jahren angegangen zu haben?</p>
                `,
                werner: `
                    <p><strong>Lieber Herr Schmidt,</strong></p>
                    <p>40 Jahre F√ºhrungsverantwortung - welch ein Geschenk an Erfahrung und Weisheit! Ihre Sorge vor dem Ruhestand zeigt, wie wichtig Ihnen Sinnhaftigkeit ist. Das wird Ihnen auch in dieser neuen Lebensphase helfen.</p>
                    <p><strong>Ihre wertvollen Ressourcen:</strong> Vier Jahrzehnte Menschenf√ºhrung, Probleml√∂sung und Verantwortung - diese Sch√§tze verschwinden nicht mit der Rente, sondern k√∂nnen auf neue Weise wirken.</p>
                    <p><strong>Zum Erkunden:</strong> Welche Momente in Ihren 40 Berufsjahren haben Ihnen die gr√∂√üte Freude bereitet? Wie k√∂nnten √§hnliche Erfahrungen auch au√üerhalb des klassischen Berufs m√∂glich sein?</p>
                `
            };
            
            return responses[selectedClient] || responses.sarah;
        }

        function shareScreen() {
            alert('üì∫ Screen-Sharing simuliert: In einer echten Session w√ºrden Sie jetzt Ihren Bildschirm mit dem Klienten teilen, damit beide die KI-Responses sehen k√∂nnen.');
        }

        function exportSession() {
            const sessionData = {
                client: clients[selectedClient],
                step: currentStep,
                timestamp: new Date().toISOString(),
                duration: document.getElementById('sessionTimer').textContent
            };
            
            const blob = new Blob([JSON.stringify(sessionData, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `coaching-session-${selectedClient}-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function endSession() {
            if (confirm('Sind Sie sicher, dass Sie die Session beenden m√∂chten?')) {
                if (sessionTimer) {
                    clearInterval(sessionTimer);
                }
                
                document.getElementById('dashboard').style.display = 'none';
                document.getElementById('clientSelection').style.display = 'block';
                
                // Reset
                selectedClient = null;
                currentStep = 1;
                document.getElementById('startButton').textContent = 'üöÄ Klient ausw√§hlen';
                document.getElementById('startButton').classList.remove('active');
                document.querySelectorAll('.client-card').forEach(card => card.classList.remove('selected'));
            }
        }

        // Initial setup
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, app ready');
            const clientCards = document.querySelectorAll('.client-card');
            console.log(`Found client cards:`, clientCards.length);
            console.log('App initialized');
        });

        // Modal schlie√üen bei Klick au√üerhalb
        window.onclick = function(event) {
            const modal = document.getElementById('promptModal');
            if (event.target === modal) {
                closePromptEditor();
            }
        }
    </script>
</body>
</html>